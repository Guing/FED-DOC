"use strict";(self.webpackChunkfed_doc=self.webpackChunkfed_doc||[]).push([[2338],{3905:function(e,n,t){t.d(n,{Zo:function(){return p},kt:function(){return h}});var s=t(67294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,s)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function a(e,n){if(null==e)return{};var t,s,l=function(e,n){if(null==e)return{};var t,s,l={},i=Object.keys(e);for(s=0;s<i.length;s++)t=i[s],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)t=i[s],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var o=s.createContext({}),u=function(e){var n=s.useContext(o),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},p=function(e){var n=u(e.components);return s.createElement(o.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return s.createElement(s.Fragment,{},n)}},d=s.forwardRef((function(e,n){var t=e.components,l=e.mdxType,i=e.originalType,o=e.parentName,p=a(e,["components","mdxType","originalType","parentName"]),d=u(t),h=l,m=d["".concat(o,".").concat(h)]||d[h]||c[h]||i;return t?s.createElement(m,r(r({ref:n},p),{},{components:t})):s.createElement(m,r({ref:n},p))}));function h(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var i=t.length,r=new Array(i);r[0]=d;var a={};for(var o in n)hasOwnProperty.call(n,o)&&(a[o]=n[o]);a.originalType=e,a.mdxType="string"==typeof e?e:l,r[1]=a;for(var u=2;u<i;u++)r[u]=t[u];return s.createElement.apply(null,r)}return s.createElement.apply(null,t)}d.displayName="MDXCreateElement"},98558:function(e,n,t){t.r(n),t.d(n,{assets:function(){return p},contentTitle:function(){return o},default:function(){return h},frontMatter:function(){return a},metadata:function(){return u},toc:function(){return c}});var s=t(87462),l=t(63366),i=(t(67294),t(3905)),r=["components"],a={},o="Week31-\u811a\u624b\u67b6\u53d1\u5e03\u6a21\u5757\u4e91\u53d1\u5e03\u529f\u80fd\u5f00\u53d1",u={unversionedId:"\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/\u811a\u624b\u67b6/31\u5468 \u811a\u624b\u67b6\u53d1\u5e03\u6a21\u5757\u4e91\u53d1\u5e03\u529f\u80fd\u5f00\u53d1/\u7b14\u8bb0",id:"\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/\u811a\u624b\u67b6/31\u5468 \u811a\u624b\u67b6\u53d1\u5e03\u6a21\u5757\u4e91\u53d1\u5e03\u529f\u80fd\u5f00\u53d1/\u7b14\u8bb0",title:"Week31-\u811a\u624b\u67b6\u53d1\u5e03\u6a21\u5757\u4e91\u53d1\u5e03\u529f\u80fd\u5f00\u53d1",description:"\u7b2c\u4e00\u7ae0 \u672c\u5468\u5bfc\u5b66",source:"@site/docs/19-\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/1-\u811a\u624b\u67b6/31\u5468 \u811a\u624b\u67b6\u53d1\u5e03\u6a21\u5757\u4e91\u53d1\u5e03\u529f\u80fd\u5f00\u53d1/101-\u7b14\u8bb0.md",sourceDirName:"19-\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/1-\u811a\u624b\u67b6/31\u5468 \u811a\u624b\u67b6\u53d1\u5e03\u6a21\u5757\u4e91\u53d1\u5e03\u529f\u80fd\u5f00\u53d1",slug:"/\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/\u811a\u624b\u67b6/31\u5468 \u811a\u624b\u67b6\u53d1\u5e03\u6a21\u5757\u4e91\u53d1\u5e03\u529f\u80fd\u5f00\u53d1/\u7b14\u8bb0",permalink:"/FED-DOC/docs/\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/\u811a\u624b\u67b6/31\u5468 \u811a\u624b\u67b6\u53d1\u5e03\u6a21\u5757\u4e91\u53d1\u5e03\u529f\u80fd\u5f00\u53d1/\u7b14\u8bb0",editUrl:"https://github.com/Guing/FED-DOC/docs/19-\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/1-\u811a\u624b\u67b6/31\u5468 \u811a\u624b\u67b6\u53d1\u5e03\u6a21\u5757\u4e91\u53d1\u5e03\u529f\u80fd\u5f00\u53d1/101-\u7b14\u8bb0.md",tags:[],version:"current",sidebarPosition:101,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"node\u5e38\u7528\u4e09\u65b9\u5e93\u4ecb\u7ecd",permalink:"/FED-DOC/docs/\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/\u811a\u624b\u67b6/31\u5468 \u811a\u624b\u67b6\u53d1\u5e03\u6a21\u5757\u4e91\u53d1\u5e03\u529f\u80fd\u5f00\u53d1/node\u5e38\u7528\u4e09\u65b9\u5e93\u4ecb\u7ecd"},next:{title:"Week32-\u811a\u624b\u67b6\u7ec4\u4ef6\u53d1\u5e03\u529f\u80fd\u5f00\u53d1",permalink:"/FED-DOC/docs/\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/\u811a\u624b\u67b6/32\u5468 \u811a\u624b\u67b6\u7ec4\u4ef6\u53d1\u5e03\u529f\u80fd\u5f00\u53d1/\u7b14\u8bb0"}},p={},c=[{value:"\u7b2c\u4e00\u7ae0 \u672c\u5468\u5bfc\u5b66",id:"\u7b2c\u4e00\u7ae0-\u672c\u5468\u5bfc\u5b66",level:3},{value:"1-1 \u672c\u5468\u4ecb\u7ecd\u548c\u5b66\u4e60\u65b9\u6cd5",id:"1-1-\u672c\u5468\u4ecb\u7ecd\u548c\u5b66\u4e60\u65b9\u6cd5",level:4},{value:"\u7b2c\u4e8c\u7ae0 \u4e91\u53d1\u5e03\u6a21\u5757\u67b6\u6784\u8bbe\u8ba1",id:"\u7b2c\u4e8c\u7ae0-\u4e91\u53d1\u5e03\u6a21\u5757\u67b6\u6784\u8bbe\u8ba1",level:3},{value:"2-1 \u524d\u7aef\u53d1\u5e03OSS\u67b6\u6784\u8bbe\u8ba1",id:"2-1-\u524d\u7aef\u53d1\u5e03oss\u67b6\u6784\u8bbe\u8ba1",level:4},{value:"2-2 \u4e91\u53d1\u5e03\u67b6\u6784\u548c\u6d41\u7a0b\u8bbe\u8ba1",id:"2-2-\u4e91\u53d1\u5e03\u67b6\u6784\u548c\u6d41\u7a0b\u8bbe\u8ba1",level:4},{value:"\u7b2c\u4e09\u7ae0 \u4e91\u53d1\u5e03\u529f\u80fd\u5f00\u53d1",id:"\u7b2c\u4e09\u7ae0-\u4e91\u53d1\u5e03\u529f\u80fd\u5f00\u53d1",level:3},{value:"3-1 \u5b9e\u73b0\u4e91\u53d1\u5e03\u524d\u7684\u9884\u68c0\u67e5\u903b\u8f91",id:"3-1-\u5b9e\u73b0\u4e91\u53d1\u5e03\u524d\u7684\u9884\u68c0\u67e5\u903b\u8f91",level:4},{value:"3-2 \u9759\u6001\u8d44\u6e90\u670d\u52a1\u5668\u7c7b\u578b\u9009\u62e9\u903b\u8f91\u5f00\u53d1",id:"3-2-\u9759\u6001\u8d44\u6e90\u670d\u52a1\u5668\u7c7b\u578b\u9009\u62e9\u903b\u8f91\u5f00\u53d1",level:4},{value:"3-3 \u4e91\u53d1\u5e03\u670d\u52a1\u7aef\u9884\u68c0\u67e5\u903b\u8f91\u5b9e\u73b0",id:"3-3-\u4e91\u53d1\u5e03\u670d\u52a1\u7aef\u9884\u68c0\u67e5\u903b\u8f91\u5b9e\u73b0",level:4},{value:"3-4 \u521b\u5efaOSS bucket+OSS\u5b9e\u4f8b\u5316\u5f00\u53d1(\u670d\u52a1\u7aef)",id:"3-4-\u521b\u5efaoss-bucketoss\u5b9e\u4f8b\u5316\u5f00\u53d1\u670d\u52a1\u7aef",level:4},{value:"3-5 \u4e91\u53d1\u5e03\u6838\u5fc3\u6d41\u7a0b\uff1a\u4e0a\u4f20OSS\u529f\u80fd\u5f00\u53d1",id:"3-5-\u4e91\u53d1\u5e03\u6838\u5fc3\u6d41\u7a0b\u4e0a\u4f20oss\u529f\u80fd\u5f00\u53d1",level:4},{value:"3-6 OSS\u57df\u540d\u7ed1\u5b9a + CDN\u7ed1\u5b9a",id:"3-6-oss\u57df\u540d\u7ed1\u5b9a--cdn\u7ed1\u5b9a",level:4},{value:"\u7b2c\u56db\u7ae0 \u4e91\u53d1\u5e03\u6d41\u7a0b\u5b8c\u5584",id:"\u7b2c\u56db\u7ae0-\u4e91\u53d1\u5e03\u6d41\u7a0b\u5b8c\u5584",level:3},{value:"4-1 \u83b7\u53d6OSS API\u5f00\u53d1",id:"4-1-\u83b7\u53d6oss-api\u5f00\u53d1",level:4},{value:"4-2 \u8986\u76d6\u53d1\u5e03\u903b\u8f91\u5f00\u53d1",id:"4-2-\u8986\u76d6\u53d1\u5e03\u903b\u8f91\u5f00\u53d1",level:4},{value:"4-3 \u670d\u52a1\u7aef\u7f13\u5b58\u6587\u4ef6\u6e05\u9664\u529f\u80fd\u5b9e\u73b0",id:"4-3-\u670d\u52a1\u7aef\u7f13\u5b58\u6587\u4ef6\u6e05\u9664\u529f\u80fd\u5b9e\u73b0",level:4},{value:"4-4 \u81ea\u52a8\u63d0\u4ea4\u4ee3\u7801 BUG \u4fee\u590d",id:"4-4-\u81ea\u52a8\u63d0\u4ea4\u4ee3\u7801-bug-\u4fee\u590d",level:4},{value:"4-5 history\u6a21\u5f0f\u53d1\u5e03\u539f\u7406\u8bb2\u89e3",id:"4-5-history\u6a21\u5f0f\u53d1\u5e03\u539f\u7406\u8bb2\u89e3",level:4},{value:"4-6 history\u6a21\u5f0f\u8fdc\u7a0b\u53d1\u5e03\u539f\u7406\u8bb2\u89e3",id:"4-6-history\u6a21\u5f0f\u8fdc\u7a0b\u53d1\u5e03\u539f\u7406\u8bb2\u89e3",level:4},{value:"4-7 \u811a\u624b\u67b6\u81ea\u52a8\u4e0a\u4f20\u6a21\u677f\u903b\u8f91\u5f00\u53d1",id:"4-7-\u811a\u624b\u67b6\u81ea\u52a8\u4e0a\u4f20\u6a21\u677f\u903b\u8f91\u5f00\u53d1",level:4},{value:"4-8 \u83b7\u53d6 OSS \u6587\u4ef6 API \u5f00\u53d1",id:"4-8-\u83b7\u53d6-oss-\u6587\u4ef6-api-\u5f00\u53d1",level:4},{value:"4-9 \u4e0a\u4f20\u6a21\u677f\u529f\u80fd\u5b9e\u73b0",id:"4-9-\u4e0a\u4f20\u6a21\u677f\u529f\u80fd\u5b9e\u73b0",level:4},{value:"4-10 \u81ea\u52a8\u6253tag+\u5408\u5e76\u4ee3\u7801\u81f3master\u5206\u652f\u6d41\u7a0b\u5f00\u53d1",id:"4-10-\u81ea\u52a8\u6253tag\u5408\u5e76\u4ee3\u7801\u81f3master\u5206\u652f\u6d41\u7a0b\u5f00\u53d1",level:4},{value:"\u7b2c\u4e94\u7ae0 \u672c\u5468\u52a0\u9910\uff1anode\u5e38\u7528\u4e09\u65b9\u5e93\u4ecb\u7ecd",id:"\u7b2c\u4e94\u7ae0-\u672c\u5468\u52a0\u9910node\u5e38\u7528\u4e09\u65b9\u5e93\u4ecb\u7ecd",level:3},{value:"5-1 Node\u9ad8\u5206\u5e93\uff1aPDF\u6587\u4ef6\u751f\u6210\u5de5\u5177\u2014\u2014PDFKit",id:"5-1-node\u9ad8\u5206\u5e93pdf\u6587\u4ef6\u751f\u6210\u5de5\u5177pdfkit",level:4},{value:"5-2 Node Excel\u5904\u7406\u5e93\u8bb2\u89e3",id:"5-2-node-excel\u5904\u7406\u5e93\u8bb2\u89e3",level:4},{value:"5-3 \u547d\u4ee4\u884c\u4ea4\u4e92\u5e93Listr\u8bb2\u89e3",id:"5-3-\u547d\u4ee4\u884c\u4ea4\u4e92\u5e93listr\u8bb2\u89e3",level:4},{value:"5-4 \u5229\u7528Listr\u5bf9\u9879\u76ee\u81ea\u52a8\u521b\u5efaTag\u903b\u8f91\u8fdb\u884c\u4f18\u5316",id:"5-4-\u5229\u7528listr\u5bf9\u9879\u76ee\u81ea\u52a8\u521b\u5efatag\u903b\u8f91\u8fdb\u884c\u4f18\u5316",level:4}],d={toc:c};function h(e){var n=e.components,a=(0,l.Z)(e,r);return(0,i.kt)("wrapper",(0,s.Z)({},d,a,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"week31-\u811a\u624b\u67b6\u53d1\u5e03\u6a21\u5757\u4e91\u53d1\u5e03\u529f\u80fd\u5f00\u53d1"},"Week31-\u811a\u624b\u67b6\u53d1\u5e03\u6a21\u5757\u4e91\u53d1\u5e03\u529f\u80fd\u5f00\u53d1"),(0,i.kt)("h3",{id:"\u7b2c\u4e00\u7ae0-\u672c\u5468\u5bfc\u5b66"},"\u7b2c\u4e00\u7ae0 \u672c\u5468\u5bfc\u5b66"),(0,i.kt)("hr",null),(0,i.kt)("h4",{id:"1-1-\u672c\u5468\u4ecb\u7ecd\u548c\u5b66\u4e60\u65b9\u6cd5"},"1-1 \u672c\u5468\u4ecb\u7ecd\u548c\u5b66\u4e60\u65b9\u6cd5"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u4e91\u53d1\u5e03\u539f\u7406\u3001\u67b6\u6784\u548c\u5b9e\u73b0"),(0,i.kt)("li",{parentName:"ul"},"OSS API(OSS\u63a5\u5165\u6307\u5357)"),(0,i.kt)("li",{parentName:"ul"},"\u4e0a\u7ebf\u53d1\u5e03\u6d41\u7a0b(\u652f\u6301Hash\u548cHistory\u6a21\u5f0f\u53d1\u5e03)"),(0,i.kt)("li",{parentName:"ul"},"\u9644\u8d60\uff1aNode\u9ad8\u5206\u5e93\u5206\u4eab(awesome-nodejs)")),(0,i.kt)("h3",{id:""}),(0,i.kt)("h3",{id:"\u7b2c\u4e8c\u7ae0-\u4e91\u53d1\u5e03\u6a21\u5757\u67b6\u6784\u8bbe\u8ba1"},"\u7b2c\u4e8c\u7ae0 \u4e91\u53d1\u5e03\u6a21\u5757\u67b6\u6784\u8bbe\u8ba1"),(0,i.kt)("hr",null),(0,i.kt)("h4",{id:"2-1-\u524d\u7aef\u53d1\u5e03oss\u67b6\u6784\u8bbe\u8ba1"},"2-1 \u524d\u7aef\u53d1\u5e03OSS\u67b6\u6784\u8bbe\u8ba1"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"CloudBuild\u5b9e\u4f8b\u6dfb\u52a0\u53c2\u6570\uff1aprod\uff08\u662f\u5426\u4e3a\u6b63\u5f0f\u7248\u672c\uff09"),(0,i.kt)("li",{parentName:"ul"},"\u6dfb\u52a0\u51c6\u5907\u9636\u6bb5 \uff1a\u83b7\u53d6OSS\u6587\u4ef6\uff0c\u8be2\u95ee\u662f\u5426\u8986\u76d6")),(0,i.kt)("h4",{id:"2-2-\u4e91\u53d1\u5e03\u67b6\u6784\u548c\u6d41\u7a0b\u8bbe\u8ba1"},"2-2 \u4e91\u53d1\u5e03\u67b6\u6784\u548c\u6d41\u7a0b\u8bbe\u8ba1"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.processon.com/embed/61127e8907912940a9654a57"},"https://www.processon.com/embed/61127e8907912940a9654a57")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.processon.com/diagraming/627b7f061e085307533cd0fe"},"https://www.processon.com/diagraming/627b7f061e085307533cd0fe")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"\u4e91\u6784\u5efa\u67b6\u6784\u8bbe\u8ba1\u56fe (1)",src:t(21922).Z,width:"616",height:"1061"})),(0,i.kt)("h3",{id:"\u7b2c\u4e09\u7ae0-\u4e91\u53d1\u5e03\u529f\u80fd\u5f00\u53d1"},"\u7b2c\u4e09\u7ae0 \u4e91\u53d1\u5e03\u529f\u80fd\u5f00\u53d1"),(0,i.kt)("hr",null),(0,i.kt)("p",null,"\u672c\u7ae0\u5185\u5bb9\u66f4\u65b0\u4ee3\u7801\u4e3a\u5206\u652f ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/liugezhou/cloudscope-cli/tree/lesson31"},"lesson31")),(0,i.kt)("h4",{id:"3-1-\u5b9e\u73b0\u4e91\u53d1\u5e03\u524d\u7684\u9884\u68c0\u67e5\u903b\u8f91"},"3-1 \u5b9e\u73b0\u4e91\u53d1\u5e03\u524d\u7684\u9884\u68c0\u67e5\u903b\u8f91"),(0,i.kt)("p",null,"\u5728\u4e0a\u4e00\u8282\u4e2d\uff0cmdoels/git/lib/index.js\u4e2d\uff0c\u6709preparePublish\u65b9\u6cd5\uff0c\u4e4b\u524d\u68c0\u67e5\u547d\u4ee4\u662f\u5426\u4e3anpm\u6216cnpm"),(0,i.kt)("p",null,"\u5728\u4e0a\u4e00\u8282\u57fa\u7840\u4e0a\uff0c\u8fd9\u91cc\u6dfb\u52a0\u4e86\uff0c\u6267\u884c\u6784\u5efa\u547d\u4ee4\u662f\u5426\u4e3a build\uff0c\u4ee3\u7801\u5982\u4e0b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"// models/git/lib/index.js\n\n\nasync preparePublish(){\n  log.info('\u5f00\u59cb\u8fdb\u884c\u4e91\u6784\u5efa\u524d\u4ee3\u7801\u68c0\u67e5')\n  \u2026\u2026\u2026\u2026\n  const pkg = this.getPackageJson()\n  const buildCmdArray = this.buildCmd.split('')\n  const buildLastCmd = buildCmArrat.slice(-1).toString()\n  if(!pkg.scripts || !Object.keys(pkg.scripts).includes(lastCmd)){\n    throw new Error(`${this.buildCmd}\u547d\u4ee4\u4e0d\u5b58\u5728`)\n  }\n  log.success('\u4e91\u6784\u5efa\u4ee3\u7801\u9884\u68c0\u67e5\u901a\u8fc7')\n}\n\ngetPackageJson(){\n    const pkgPath = path.resolve(this.dir,'package.json')\n  if(!fs.existSync(pkgPath)){\n    throw new Error(`package.json\u4e0d\u5b58\u5728,\u6e90\u7801\u76ee\u5f55:${this.dir}`)\n  }\n  return fse.readJsonSync(pkgPath)\n}\n")),(0,i.kt)("h4",{id:"3-2-\u9759\u6001\u8d44\u6e90\u670d\u52a1\u5668\u7c7b\u578b\u9009\u62e9\u903b\u8f91\u5f00\u53d1"},"3-2 \u9759\u6001\u8d44\u6e90\u670d\u52a1\u5668\u7c7b\u578b\u9009\u62e9\u903b\u8f91\u5f00\u53d1"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u4e0a\u4e00\u8282\u6211\u4eec\u68c0\u67e5\u4e86build\u8fd9\u4e2a\u547d\u4ee4")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u63a5\u7740\uff0c\u6211\u4eec\u9700\u8981\u9009\u62e9\u4e0a\u4f20\u8d44\u6e90\u670d\u52a1\u5668\u7684\u7c7b\u578b\uff0c\u4e5f\u5c31\u662fOSS")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u8fd9\u91cc\u7684\u4ee3\u7801\u662f\u4e3a\u4e86\u540e\u7eed\u5982\u679c\u8981\u4fee\u6539\u8d44\u6e90\u670d\u52a1\u5668\u7c7b\u578b\uff0c\u53ef\u4ee5\u8fdb\u884c\u4ee3\u7801\u7684\u518d\u5f00\u53d1--\u6dfb\u52a0\u5176\u4ed6\u8d44\u6e90\u670d\u52a1\u5668\u7c7b\u578b\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u4e0e\u68c0\u67e5git_token\u6216\u8005git_server\u7b49\u4e00\u6837\uff0c\u672c\u8282\u9700\u8981\u53bb\u65b0\u5efa\u6216\u8005\u68c0\u67e5.git_publish\u6587\u4ef6\uff0c\u4ee3\u7801\u5b9e\u73b0\u5982\u4e0b"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u6700\u540e\uff0ccloudscope-cli publish\u8fd9\u4e2a\u547d\u4ee4\u6dfb\u52a0\u4e86 --prod\u8fd9\u4e2a\u53c2\u6570,\u4ee5\u53ca.git_publish\u6587\u4ef6\u5185\u5bb9\uff0c\u4f20\u5165\u5230 Cloudbuild\u7c7b\u4e2d\u53bb"))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"// models/git/lib/index.js\nconst GIT_PUBLISH_FILE='.git_publish'\nconst GIT_PUBLISH_TYPE=[{\n    name:'OSS',\n    value:'oss'\n}]\n\n async preparePublish(){\n   log.info('\u5f00\u59cb\u8fdb\u884c\u4e91\u6784\u5efa\u524d\u4ee3\u7801\u68c0\u67e5')\n   \u2026\u2026\u2026\u2026\u2026\u2026\n   log.success('\u4e91\u6784\u5efa\u4ee3\u7801\u9884\u68c0\u67e5\u901a\u8fc7')\n\n   const gitPublishPath = this.createPath(GIT_PUBLISH_FILE)\n   let gitPublish = readFile(gitPublishPath)\n   if(!gitPublish){ // \u5982\u679c\u6ca1\u6709\u8bfb\u53d6\u5230.git-publish\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\n     gitPublish = await this.choicePublish(gitPublishPath)\n     log.success('git publish \u5199\u5165\u6210\u529f',`${gitPublish} -> ${gitPublishPath}`)\n   }else{ // \u5982\u679c\u8bfb\u53d6\u5230\u4e86 \u5185\u5bb9\n     log.success('git publish \u6587\u4ef6\u8bfb\u53d6\u6210\u529f\uff01')\n   }\n   this.gitPublish = gitPublish\n }\n\nasync choicePublish(gitPublishPath){\n  const gitPublish = (await inquirer.prompt({\n    type:'list',\n    name:'gitPublish',\n    message:'\u8bf7\u9009\u62e9\u4f60\u60f3\u8981\u4e0a\u4f20\u4ee3\u7801\u7684\u5e73\u53f0',\n    choices:GIT_PUBLISH_TYPE\n  })).gitPublish;\n  writeFile(gitPublishPath,gitPublish)\n  return gitPublish\n}\n")),(0,i.kt)("p",null,"\u5173\u4e8e --prod\u53c2\u6570\u7684\u4f20\u5165\uff0c\u4e0e--refreshToken\u7b49\u4e00\u6837\uff0c\u8fd9\u91cc\u5c31\u4e0d\u505a\u6f14\u793a\u4e86\u3002"),(0,i.kt)("h4",{id:"3-3-\u4e91\u53d1\u5e03\u670d\u52a1\u7aef\u9884\u68c0\u67e5\u903b\u8f91\u5b9e\u73b0"},"3-3 \u4e91\u53d1\u5e03\u670d\u52a1\u7aef\u9884\u68c0\u67e5\u903b\u8f91\u5b9e\u73b0"),(0,i.kt)("p",null,"\u672c\u8282\u662f\u670d\u52a1\u7aef\u76f8\u5173\u7684\u4ee3\u7801\u5b9e\u73b0\uff0c\u540c\u6837\u4ee3\u7801\u4e3a\u5206\u652f ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/liugezhou/cloudscope-cli-server/tree/lesson31"}," lesson31")),(0,i.kt)("p",null,"\u4e3b\u8981\u662f\u62ff\u5230\u4e91\u6784\u5efa\u7ed3\u679c\u7684dist\u6216\u8005build\u76ee\u5f55"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"// app/io/controller/build.js\n await prePublish(cloudBuildTask,socket,helper)\n\nasync function prePublish(cloudBuildTask,socket,helper){\n  socket.emit('build',helper.parseMsg('pre-publish',{\n    message:'\u5f00\u59cb\u53d1\u5e03\u524d\u68c0\u67e5'\n  }))\n  const prePublishRes = await cloudBuildTask.prePublish()\n  if(!prePublishRes || Object.is(prePublishRes.code,FAILED)){ \n    socket.emit('build',helper.parseMsg('pre-publish failed',{\n      message:'\u53d1\u5e03\u524d\u68c0\u67e5\u5931\u8d25,\u5931\u8d25\u539f\u56e0\uff1a' + (prePublishRes && prePublishRes.message ? prePublishRes.message:'\u672a\u77e5')\n    }))\n    throw new Error('\u53d1\u5e03\u7ec8\u6b62')\n  }else{\n    socket.emit('build',helper.parseMsg('pre-publish',{\n      message:'\u53d1\u5e03\u524d\u68c0\u67e5\u901a\u8fc7'\n    }))\n  }\n}\n\n//app/models/cloudBuildTask.js\nasync prePublish(){\n  //\u83b7\u53d6\u6784\u5efa\u7ed3\u679c\n  const buildPath = this.findBuildPath()\n  //\u68c0\u67e5\u6784\u5efa\u7ed3\u679c\n  if(!buildPath){\n    return this.failed('\u672a\u627e\u5230\u6784\u5efa\u7ed3\u679c\uff0c\u8bf7\u68c0\u67e5')\n  }\n  this._buildPath = buildPath\n  return this.success()\n}\n\n\n\nfindBuildPath(){\n  const buildDir =['build','dist']\n  const buildPath = buildDir.find(dir=>fs.existsSync(path.resolve(this._sourceCodeDir,dir)))\n  this._ctx.logger.info('buildPath',buildPath)\n  if(buildPath){\n    return path.resolve(this._sourceCodeDir,buildPath)\n  }\n  return null\n}\n")),(0,i.kt)("h4",{id:"3-4-\u521b\u5efaoss-bucketoss\u5b9e\u4f8b\u5316\u5f00\u53d1\u670d\u52a1\u7aef"},"3-4 \u521b\u5efaOSS bucket+OSS\u5b9e\u4f8b\u5316\u5f00\u53d1(\u670d\u52a1\u7aef)"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"cnpm install -S ali-oss"),(0,i.kt)("li",{parentName:"ul"},"\u5ba2\u6237\u7aef\u4f20\u9012prod\u53c2\u6570\u5230\u670d\u52a1\u7aef\uff0c\u670d\u52a1\u7aef\u6839\u636eprod\u53c2\u6570\uff0c\u83b7\u53d6\u4e0d\u540c\u73af\u5883\u7684OSS")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"// app/models/CloudBuildTask.js\nconst OSS = require('./OSS')\nconst config = require('../../config/db')\nclass CloudBuildTask(options,ctx){\n    constructor(){\n      this._prod = options.prod === 'true' ? true : false\n  }\n}\n\nasync prepare(){\n  fse.ensureDirSync(this._dir)\n  fse.emptyDirSync(this._dir)\n  this._git = new Git(this._dir)\n  if(this._prod){ //\u751f\u4ea7\u51c6\u5907OSS\n    this.oss =new OSS(config.OSS_PROD_BUCKET)\n  }else{//\u6d4b\u8bd5\n    this.oss =new OSS(config.OSS_DEV_BUCKET)\n  }\n  console.log(this.oss)\n  return this.success()\n}\n\n// app/models/OSS.js\n'use strict';\nconst OSS = require('ali-oss');\nconst config = require('../../config/db')\nclass OSS{\n    constructor(bucket){\n        this.oss = new OSS({\n            region:config.OSS_REGION,\n            accessKeyId: config.OSS_ACCESS_KEY,\n            accessKeySecret: config.OSS_ACCESS_SECRET_KEY,\n            bucket,\n        })\n    }\n}\n\nmodule.exports = OSS\n\n//app/config/db.js\nconst fs = require('fs')\nconst path = require('path')\nconst userHome = require('user-home')\nconst OSS_ACCESS_KEY = ''\nconst OSS_ACCESS_SECRET_KEY = fs.readFileSync(path.resolve(userHome,'.cloudscope-cli','oss_access_secret_key')).toString()\nconst OSS_PROD_BUCKET=''\nconst OSS_DEV_BUCKET=''\nconst OSS_REGION=''\n")),(0,i.kt)("p",null,"\u4ee5\u4e0a\u5173\u4e8eOSS Key\u7b49\u7684\u914d\u7f6e\uff0c\u53ef\u53bb\u963f\u91cc\u4e91\u514d\u8d39\u8bd5\u7528\u4e00\u4e2a\u6708OSS\u5bf9\u8c61\u5b58\u50a8\u529f\u80fd\uff0c\u586b\u5165\u76f8\u5e94\u7684\u503c\u3002"),(0,i.kt)("h4",{id:"3-5-\u4e91\u53d1\u5e03\u6838\u5fc3\u6d41\u7a0b\u4e0a\u4f20oss\u529f\u80fd\u5f00\u53d1"},"3-5 \u4e91\u53d1\u5e03\u6838\u5fc3\u6d41\u7a0b\uff1a\u4e0a\u4f20OSS\u529f\u80fd\u5f00\u53d1"),(0,i.kt)("p",null,"\u4ee3\u7801\u903b\u8f91\u5982\u4e0b"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"npm i -S glob")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"// app/io/controller/build.js\n\nawait publish(cloudBuildTask,socket,helper)\n\nasync function publish(cloudBuildTask,socket,helper){\n  socket.emit('build',helper.parseMsg('publish',{\n    message:'\u5f00\u59cb\u53d1\u5e03'\n  }))\n  const publishRes = await cloudBuildTask.publish()\n  if(!publishRes || Object.is(publishRes.code,FAILED)){ //  downlod\u4e0b\u8f7d\u5931\u8d25\n    socket.emit('build',helper.parseMsg('publish failed',{\n      message:'\u53d1\u5e03\u5931\u8d25'\n    }))\n    return \n  }else{\n    socket.emit('build',helper.parseMsg('publish',{\n      message:'\u53d1\u5e03\u6210\u529f'\n    }))\n  }\n}\n\n// app/models/CloudBuildTask.js\n  async publish(){\n    return new Promise((resolve,reject) =>{\n      glob('**',{\n        cwd:this._buildPath,\n        nodir:true,\n        ignore:'**/node_modules/**'\n      },(err,files) =>{\n        if(err){\n          resolve(false)\n        }else{\n          Promise.all(files.map(async file=>{\n            console.log(file)\n            const filePath = path.resolve(this._buildPath,file)\n            const uploadOSSRes = await this.oss.put(`${this._name}/${file}`,filePath) \n            return uploadOSSRes\n          })).then(()=>{\n            resolve(true)\n          }).catch(err=>{\n            this._ctx.logger.error(err)\n            resolve(false)\n          })\n        }\n      })\n    })\n  }\n\n// app/models/OSS.js\n\n async put(object, localPath, options = {}) {\n   await this.oss.put(object, localPath, options);\n }\n")),(0,i.kt)("p",null,"\u6700\u540e\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u5728\u963f\u91cc\u4e91\u63a7\u5236\u53f0\u770b\u5230\u76f8\u5173\u7684OSS\u6587\u4ef6\u5df2\u4e0a\u4f20\u3002"),(0,i.kt)("h4",{id:"3-6-oss\u57df\u540d\u7ed1\u5b9a--cdn\u7ed1\u5b9a"},"3-6 OSS\u57df\u540d\u7ed1\u5b9a + CDN\u7ed1\u5b9a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u57df\u540d\u7ed1\u5b9a"),(0,i.kt)("li",{parentName:"ul"},"CDN\u7ed1\u5b9a")),(0,i.kt)("h3",{id:"\u7b2c\u56db\u7ae0-\u4e91\u53d1\u5e03\u6d41\u7a0b\u5b8c\u5584"},"\u7b2c\u56db\u7ae0 \u4e91\u53d1\u5e03\u6d41\u7a0b\u5b8c\u5584"),(0,i.kt)("hr",null),(0,i.kt)("h4",{id:"4-1-\u83b7\u53d6oss-api\u5f00\u53d1"},"4-1 \u83b7\u53d6OSS API\u5f00\u53d1"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u670d\u52a1\u7aef")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"router.js\u4e2d\u6dfb\u52a0\u8def\u7531 router.get('/project/oss', controller.project.getOSSProject);"))),(0,i.kt)("p",null,"\u672c\u8282\u4e3b\u8981\u662f\u83b7\u53d6OSS\u4e0a\u4f20\u7684\u6587\u4ef6\uff0c\u4f7f\u7528oss\u7684"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"// app/controller/project.js\nconst { failed } = require(\"../utils/request\")\nconst OSS = require('../models/OSS')\nconst config = require('../../config/db')\n\nasync getOSSProject(){\n  const { ctx } = this\n    const ossProjectType = ctx.query.type\n  const ossProjectName = ctx.query.name\n  if(!ossProjectName){\n    ctx.body = failed('\u9879\u76ee\u540d\u79f0\u4e0d\u5b58\u5728)\n    return\n  }\n  if(!ossProjectType){\n    ossProjectType = 'prod'\n  }\n  let oss;\n  if(Object.is(ossProjectType,'prod')){\n    oss = new OSS(config.OSS_DEV_BUCKET)\n  }else{\n    oss = new OSS(config.OSS_PROD_BUCKET)\n    }\n  const ossList = await oss.list(ossProjectName)\n  ctx.body = ossList\n}\n  \n  \n  //app/utils/request.js\n  'use strict'\n  function success(message,data){\n    return {\n            code:0,\n        message,\n        data\n    }\n  }\n  function failed(message,data){\n    return {\n            code:-1,\n        message,\n        data\n    }\n  }\n  \n  module.exports = {\n    success,\n    failed\n  }\n\n\n//app/models/OSS.js\nasync list({prefix}){\n    const ossFileList = await this.oss.list({prefix})\n  if(ossFileList && ossFileList.objects){\n    return ossFileList.objects\n  }\n  return []\n}\n")),(0,i.kt)("h4",{id:"4-2-\u8986\u76d6\u53d1\u5e03\u903b\u8f91\u5f00\u53d1"},"4-2 \u8986\u76d6\u53d1\u5e03\u903b\u8f91\u5f00\u53d1"),(0,i.kt)("p",null,"\u670d\u52a1\u7aef\u63d0\u4f9b\u4e86\u83b7\u53d6OSS\u6587\u4ef6\u5217\u8868\u7684\u63a5\u53e3\uff0c\u63a5\u7740\u8981\u5728\u5ba2\u6237\u7aef\u53bb\u8bf7\u6c42OSS\u4e0a\u662f\u5426\u6709\u6587\u4ef6\uff0c\u4e14\u662f\u5426\u53d1\u5e03\u3002"),(0,i.kt)("p",null,"\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"// models/cloudbuild/index.js\nconst getProjectOSS = require('./getProjectOSS')\nasync prepare(){\n  // \u5224\u65ad\u662f\u5426\u5904\u4e8e\u6b63\u5f0f\u53d1\u5e03\n  if(this.prod){\n    // 1.\u83b7\u53d6OSS\u6587\u4ef6 \n    const name = this.git.name\n    const type = this.prod ? 'prod':'dev'\n    const ossProject = await getProjectOSS({name,type})\n    console.log(ossProject)\n    //2.\u5224\u65ad\u5f53\u524d\u9879\u76eeOSS\u6587\u4ef6\u662f\u5426\u5b58\u5728\n    if(Object.is(ossProject.code,0) && ossProject.data.length>0){\n      // 3.\u8be2\u95ee\u5ba2\u6237\u662f\u5426\u8fdb\u884c\u8986\u76d6\u5b89\u88c5\n      const cover = (await inquirer.prompt({\n        type:'list',\n        defaultValue:true,\n        name:'cover',\n        message:`OSS\u5df2\u5b58\u5728[${name}]\u9879\u76ee\uff0c\u662f\u5426\u5f3a\u884c\u8986\u76d6\u53d1\u5e03\uff1f`,\n        choices:[{\n          name:'\u8986\u76d6\u53d1\u5e03',\n          value:true\n        },{\n          name:'\u653e\u5f03\u53d1\u5e03',\n          value:false\n        }]\n      })).cover\n      if(!cover){ //\u653e\u5f03\u53d1\u5e03\n        throw new Error('\u53d1\u5e03\u7ec8\u6b62')\n      }\n    }\n  }\n}\n\n// models/cloudbuild/cloudbuild.js\nconst request = require('@cloudscope-cli/request')\n\nmodule.exports = function (data) {\n  return request({\n    url:'/project/oss',\n    method:'get',\n    params:data\n  })\n}\n")),(0,i.kt)("h4",{id:"4-3-\u670d\u52a1\u7aef\u7f13\u5b58\u6587\u4ef6\u6e05\u9664\u529f\u80fd\u5b9e\u73b0"},"4-3 \u670d\u52a1\u7aef\u7f13\u5b58\u6587\u4ef6\u6e05\u9664\u529f\u80fd\u5b9e\u73b0"),(0,i.kt)("p",null,"\u672c\u8282\u4e3b\u8981\u662f\u5bf9redis\u4ee5\u53ca\u7f13\u5b58\u6587\u4ef6\u8fdb\u884c\u6e05\u9664,\u5e76\u5728build\u7ed3\u675f\u540e\uff0c\u65ad\u5f00\u94fe\u63a5"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"// app/io/middleware/auth.js\n//\u6e05\u9664\u7f13\u5b58\u6587\u4ef6\nconst cloudBuildTask = await createCloudBuildTask(ctx,app)\nawait cloudBuildTask.clean()\n\n// app/models/CloudBuildTask \nasync clean(){\n  if (fs.existsSync(this._dir)) {\n    fse.removeSync(this._dir);\n  }\n  const { socket } = this._ctx;\n  const client = socket.id;\n  const redisKey = `${REDIS_PREFIX}:${client}`;\n  await this._app.redis.del(redisKey);\n}\n\n// app/io/controller/build.js\n socket.emit('build',helper.parseMsg('build success',{\n   message:`\u4e91\u6784\u5efa\u6210\u529f\uff0c\u8bbf\u95ee\u94fe\u63a5\uff1ahttps://${cloudBuildTask._prod ? 'cloudscope-cli' : 'cloudscope-cli-dev'}.liugezhou.online/${cloudBuildTask._name}/index.html`\n }))\nsocket.disconnect()\n")),(0,i.kt)("h4",{id:"4-4-\u81ea\u52a8\u63d0\u4ea4\u4ee3\u7801-bug-\u4fee\u590d"},"4-4 \u81ea\u52a8\u63d0\u4ea4\u4ee3\u7801 BUG \u4fee\u590d"),(0,i.kt)("p",null,"\u672c\u5730\u672a\u51fa\u9519"),(0,i.kt)("h4",{id:"4-5-history\u6a21\u5f0f\u53d1\u5e03\u539f\u7406\u8bb2\u89e3"},"4-5 history\u6a21\u5f0f\u53d1\u5e03\u539f\u7406\u8bb2\u89e3"),(0,i.kt)("p",null,"\u4f7f\u7528 createWebHistory\u53d1\u5e03\u4ee3\u7801\u65f6\uff0c\u5728OSS\u670d\u52a1\u5668\uff0c\u6539\u53d8url\u5730\u5740\uff0c\u518d\u5237\u65b0\u7684\u8bdd\uff0c\u4f1a\u663e\u793a404\uff0c\u5728nginx\u4e2d\u6709try_files\u7684\u914d\u7f6e\uff0c\u800c\u6211\u4eec\u8fd9\u91cc\u6ca1\u6709\uff0c\u56e0\u6b64\u9664\u4e86\u5c06createWebhistory\u6539\u4e3acreateWebHashHistory\u6a21\u5f0f\u5916\uff0c\u672c\u8282\u8bfe\u8bb2\u8ff0history\u6a21\u5f0f\u53d1\u5e03\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898---\u901a\u8fc7",(0,i.kt)("strong",{parentName:"p"},"\u672c\u5730"),"\u65b9\u5f0f\u6f14\u793a\u3002"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u9996\u5148\uff0chistory\u6a21\u5f0f\uff0c\u9700\u8981\u5728nginx\u4e0a\u505a\u914d\u7f6e")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u7136\u540e\uff0c\u5206\u4e24\u4e2a\u6b65\u9aa4\u5b9e\u73b0")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"index.html\u653e\u5230nginx\u670d\u52a1\u5668\u6307\u5b9a\u4f4d\u7f6e,\u914d\u7f6e\u597d\u8fd9\u4e2anginx"),(0,i.kt)("li",{parentName:"ul"},"css/js\u7b49\u6587\u4ef6\u4e0a\u4f20\u5230OSS\u670d\u52a1\u5668\u4e0a")))),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"vue.config.js\u4e2d\u914d\u7f6eOSS\u8def\u5f84publicPath"))),(0,i.kt)("p",null,"module.exports= {"),(0,i.kt)("p",null,"publicPath:'",(0,i.kt)("a",{parentName:"p",href:"https://xxxx.online/vue-router-demo/'"},"https://xxxx.online/vue-router-demo/'")),(0,i.kt)("p",null," }"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"\u672c\u5730\u6253\u5305\u6587\u4ef6dist\u4e0b\u76ee\u5f55\u624b\u52a8\u4e0a\u4f20\u81f3oss\u670d\u52a1\u5668   \uff1avue-router-demo\u76ee\u5f55\u4e0b\u3002"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"\u5c06\u672c\u5730dist/index.html\u4e0b\u6587\u4ef6\u590d\u5236\u5230Desktop/vue-router/index.html\u4e2d\u3002"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"\u914d\u7f6e\u60a8\u9009\u914d\u7f6e\u6587\u4ef6")))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'server {\n  listen  8081;\n  server_name resource;\n  root /Users/liumingzhou/Desktop/ ;\n  autoindex on;\n  location / {\n    add_header  Access-Control-Allow-Origin *;\n\n  }\n  location /vue-router-demo {\n    try_files  $uri  $uri/  /vue-router-demo/index.html;\n  }\n  add_header   Cache-Control "no-cache, must-revalidate";\n}\n')),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"\u8fd9\u4e2a\u65f6\u5019\u542f\u52a8\u672c\u5730nginx\u670d\u52a1\u5668\uff0c\u8bbf\u95ee8081\u7aef\u53e3\uff0c\u518d\u5237\u65b0\u9875\u9762\uff0chistpry\u8def\u7531\u6a21\u5f0f\u5c31\u4e0d\u4f1a\u62a5404\u4e86"))),(0,i.kt)("h4",{id:"4-6-history\u6a21\u5f0f\u8fdc\u7a0b\u53d1\u5e03\u539f\u7406\u8bb2\u89e3"},"4-6 history\u6a21\u5f0f\u8fdc\u7a0b\u53d1\u5e03\u539f\u7406\u8bb2\u89e3"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u767b\u5f55ESC\u670d\u52a1\u5668")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u914d\u7f6enginx")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u672c\u5730\u6587\u4ef6\u4e0a\u4f20\u5230\u670d\u52a1\u5668 ")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"scp -r /User/liugezhou/Desktop/vue-router-demo/index.html  root@liugezhou:upload/test")))),(0,i.kt)("h4",{id:"4-7-\u811a\u624b\u67b6\u81ea\u52a8\u4e0a\u4f20\u6a21\u677f\u903b\u8f91\u5f00\u53d1"},"4-7 \u811a\u624b\u67b6\u81ea\u52a8\u4e0a\u4f20\u6a21\u677f\u903b\u8f91\u5f00\u53d1"),(0,i.kt)("h4",{id:"4-8-\u83b7\u53d6-oss-\u6587\u4ef6-api-\u5f00\u53d1"},"4-8 \u83b7\u53d6 OSS \u6587\u4ef6 API \u5f00\u53d1"),(0,i.kt)("h4",{id:"4-9-\u4e0a\u4f20\u6a21\u677f\u529f\u80fd\u5b9e\u73b0"},"4-9 \u4e0a\u4f20\u6a21\u677f\u529f\u80fd\u5b9e\u73b0"),(0,i.kt)("p",null,"\u901a\u8fc7\u4e09\u4e2a\u65b0\u7684\u53c2\u6570\uff1asshUser \u3001sshIp\u3001sshPath\u7ee7\u7eed\u4e0b\u4e00\u6b65\uff0c\u5177\u4f53\u4ee3\u7801\u5c31\u4e0d\u8d34\u4e86\uff0c\u8fd9\u51e0\u7ae0\u5c31\u53ea\u662f\u6d41\u7a0b\u7684\u95ee\u9898\u4e86\u3002"),(0,i.kt)("h4",{id:"-1"}),(0,i.kt)("h4",{id:"4-10-\u81ea\u52a8\u6253tag\u5408\u5e76\u4ee3\u7801\u81f3master\u5206\u652f\u6d41\u7a0b\u5f00\u53d1"},"4-10 \u81ea\u52a8\u6253tag+\u5408\u5e76\u4ee3\u7801\u81f3master\u5206\u652f\u6d41\u7a0b\u5f00\u53d1"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u672c\u8282\u8bfe\u76f4\u63a5\u770b\u7740\u4ed3\u5e93\u4ee3\u7801\uff0c\u5177\u4f53\u7684\u6d41\u7a0b\u8fd8\u9700\u8981\u540e\u7eed\u6df1\u5ea6\u5b66\u4e60\u3002")),(0,i.kt)("h3",{id:"\u7b2c\u4e94\u7ae0-\u672c\u5468\u52a0\u9910node\u5e38\u7528\u4e09\u65b9\u5e93\u4ecb\u7ecd"},"\u7b2c\u4e94\u7ae0 \u672c\u5468\u52a0\u9910\uff1anode\u5e38\u7528\u4e09\u65b9\u5e93\u4ecb\u7ecd"),(0,i.kt)("hr",null),(0,i.kt)("h4",{id:"5-1-node\u9ad8\u5206\u5e93pdf\u6587\u4ef6\u751f\u6210\u5de5\u5177pdfkit"},"5-1 Node\u9ad8\u5206\u5e93\uff1aPDF\u6587\u4ef6\u751f\u6210\u5de5\u5177\u2014\u2014PDFKit"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/sindresorhus/awesome-nodejs"},"awesome-nodejs")),(0,i.kt)("p",null,"\u672c\u8282sam\u8001\u5e08\uff0c\u4e3b\u8981\u662f\u8bb2\u89e3\u4e86\u8fd9\u4e2a",(0,i.kt)("a",{parentName:"p",href:"https://github.com/foliojs/pdfkit"},"pdfkit"),"\u5e93\u3002"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u521b\u5efa\u4e00\u4e2anodejs\u9879\u76ee:npm init -y"),(0,i.kt)("li",{parentName:"ul"},"npm install -S pdfkit"),(0,i.kt)("li",{parentName:"ul"},"\u65b0\u5efakit/index.js,\u5b98\u65b9\u4ed3\u5e93\u4ee3\u7801copy\u5982\u4e0b\uff1a")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"const PDFDocument = require('pdfkit');\nconst fs = require('fs');\n\n// Create a document\nconst doc = new PDFDocument();\n\n// Pipe its output somewhere, like to a file or HTTP response\n// See below for browser usage\ndoc.pipe(fs.createWriteStream('output.pdf'));\n\n// Embed a font, set the font size, and render some text\ndoc\n  .font('fonts/PalatinoBold.ttf')\n  .fontSize(25)\n  .text('Some text with an embedded font!', 100, 100);\n\n// Add an image, constrain it to a given size, and center it vertically and horizontally\ndoc.image('path/to/image.png', {\n  fit: [250, 300],\n  align: 'center',\n  valign: 'center'\n});\n\n// Add another page\ndoc\n  .addPage()\n  .fontSize(25)\n  .text('Here is some vector graphics...', 100, 100);\n\n// Draw a triangle\ndoc\n  .save()\n  .moveTo(100, 150)\n  .lineTo(100, 250)\n  .lineTo(200, 250)\n  .fill('#FF3300');\n\n// Apply some transforms and render an SVG path with the 'even-odd' fill rule\ndoc\n  .scale(0.6)\n  .translate(470, -380)\n  .path('M 250,75 L 323,301 131,161 369,161 177,301 z')\n  .fill('red', 'even-odd')\n  .restore();\n\n// Add some text with annotations\ndoc\n  .addPage()\n  .fillColor('blue')\n  .text('Here is a link!', 100, 100)\n  .underline(100, 100, 160, 27, { color: '#0000FF' })\n  .link(100, 100, 160, 27, 'http://google.com/');\n\n// Finalize PDF file\ndoc.end();\n")),(0,i.kt)("h4",{id:"5-2-node-excel\u5904\u7406\u5e93\u8bb2\u89e3"},"5-2 Node Excel\u5904\u7406\u5e93\u8bb2\u89e3"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/dtjohnson/xlsx-populate"},"https://github.com/dtjohnson/xlsx-populate")),(0,i.kt)("h4",{id:"5-3-\u547d\u4ee4\u884c\u4ea4\u4e92\u5e93listr\u8bb2\u89e3"},"5-3 \u547d\u4ee4\u884c\u4ea4\u4e92\u5e93Listr\u8bb2\u89e3"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/sindresorhus/np"},"np"),"\uff1aBetter npm publish"),(0,i.kt)("li",{parentName:"ul"},"np\u6838\u5fc3\u5e93\uff1a",(0,i.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/listr"},"listr"))),(0,i.kt)("h4",{id:"5-4-\u5229\u7528listr\u5bf9\u9879\u76ee\u81ea\u52a8\u521b\u5efatag\u903b\u8f91\u8fdb\u884c\u4f18\u5316"},"5-4 \u5229\u7528Listr\u5bf9\u9879\u76ee\u81ea\u52a8\u521b\u5efaTag\u903b\u8f91\u8fdb\u884c\u4f18\u5316"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"const Listr = require('listr')\nconst { Observable } = require('rxjs')\n\nconst tasks = new Listr([\n    {\n        title:'Task1',\n        task:()=>new Listr([{\n            title:'Task1-1',\n            task:()=>{\n                return new Observable(o=>{\n                    o.next('Task-1-1')\n                    setTimeout(() => {\n                        o.next('Task-1-1-1')\n                        o.complete()\n                    }, 1000);\n                    \n                })\n            }\n        }])\n    },\n    {\n        title:'Task2',\n        task:()=>{\n            throw new Error('error')\n    },\n}\n])\ntasks.run()\nprocess.on('unhandledRejection',(e)=>{\n    console.log(e.message)\n})\n")))}h.isMDXComponent=!0},21922:function(e,n,t){n.Z=t.p+"assets/images/\u4e91\u6784\u5efa\u67b6\u6784\u8bbe\u8ba1\u56fe (1)-7d37e95732cb5a53121d29682f7a4e8d.png"}}]);