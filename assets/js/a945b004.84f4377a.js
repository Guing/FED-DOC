"use strict";(self.webpackChunkfed_doc=self.webpackChunkfed_doc||[]).push([[4964],{3905:function(e,n,t){t.d(n,{Zo:function(){return s},kt:function(){return m}});var a=t(67294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,a,l=function(e,n){if(null==e)return{};var t,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var p=a.createContext({}),u=function(e){var n=a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},s=function(e){var n=u(e.components);return a.createElement(p.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},c=a.forwardRef((function(e,n){var t=e.components,l=e.mdxType,r=e.originalType,p=e.parentName,s=o(e,["components","mdxType","originalType","parentName"]),c=u(t),m=l,k=c["".concat(p,".").concat(m)]||c[m]||d[m]||r;return t?a.createElement(k,i(i({ref:n},s),{},{components:t})):a.createElement(k,i({ref:n},s))}));function m(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var r=t.length,i=new Array(r);i[0]=c;var o={};for(var p in n)hasOwnProperty.call(n,p)&&(o[p]=n[p]);o.originalType=e,o.mdxType="string"==typeof e?e:l,i[1]=o;for(var u=2;u<r;u++)i[u]=t[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}c.displayName="MDXCreateElement"},54962:function(e,n,t){t.r(n),t.d(n,{assets:function(){return s},contentTitle:function(){return p},default:function(){return m},frontMatter:function(){return o},metadata:function(){return u},toc:function(){return d}});var a=t(87462),l=t(63366),r=(t(67294),t(3905)),i=["components"],o={},p=void 0,u={unversionedId:"\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/\u7f16\u8f91\u5668/18\u5468 \u7f16\u8f91\u5668\u7ec4\u4ef6\u56fe\u5c42\u9762\u677f\u529f\u80fd\u5f00\u53d1/\u7b14\u8bb0",id:"\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/\u7f16\u8f91\u5668/18\u5468 \u7f16\u8f91\u5668\u7ec4\u4ef6\u56fe\u5c42\u9762\u677f\u529f\u80fd\u5f00\u53d1/\u7b14\u8bb0",title:"\u7b14\u8bb0",description:"\u6b22\u8fce\u5927\u5bb6\u56de\u5230B\u7aef\u9879\u76ee\u7684\u5f00\u53d1\uff0c\u8fd9\u5468\u8ba9\u6211\u4eec\u7740\u773c\u4e8e\u7f16\u8f91\u5668\u53f3\u4fa7\u8bbe\u7f6e\u90e8\u5206\u7684\u7f16\u7801\u5de5\u4f5c\uff0c\u5b8c\u6210\u7ec4\u4ef6\u5c5e\u6027\u8bbe\u7f6e\uff0c\u56fe\u5c42\u8bbe\u7f6e\uff0c\u4ee5\u53ca\u9875\u9762\u8bbe\u7f6e\u7684\u4e00\u7cfb\u5217\u529f\u80fd\u3002\u4e3a\u4e86\u4e0d\u8ba9\u5927\u5bb6\u9677\u5165\u4e1a\u52a1\u7684\u6ce5\u6f6d\u4e2d\uff0c\u4f1a\u6311\u9009\u5178\u578b\u7684\u51e0\u4e2a\u4e1a\u52a1\u548c\u77e5\u8bc6\u70b9\u8bb2\u884c\u8bb2\u672f\u548c\u5f00\u53d1",source:"@site/docs/19-\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/2-\u7f16\u8f91\u5668/18\u5468 \u7f16\u8f91\u5668\u7ec4\u4ef6\u56fe\u5c42\u9762\u677f\u529f\u80fd\u5f00\u53d1/\u7b14\u8bb0.md",sourceDirName:"19-\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/2-\u7f16\u8f91\u5668/18\u5468 \u7f16\u8f91\u5668\u7ec4\u4ef6\u56fe\u5c42\u9762\u677f\u529f\u80fd\u5f00\u53d1",slug:"/\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/\u7f16\u8f91\u5668/18\u5468 \u7f16\u8f91\u5668\u7ec4\u4ef6\u56fe\u5c42\u9762\u677f\u529f\u80fd\u5f00\u53d1/\u7b14\u8bb0",permalink:"/FED-DOC/docs/\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/\u7f16\u8f91\u5668/18\u5468 \u7f16\u8f91\u5668\u7ec4\u4ef6\u56fe\u5c42\u9762\u677f\u529f\u80fd\u5f00\u53d1/\u7b14\u8bb0",editUrl:"https://github.com/Guing/FED-DOC/docs/19-\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/2-\u7f16\u8f91\u5668/18\u5468 \u7f16\u8f91\u5668\u7ec4\u4ef6\u56fe\u5c42\u9762\u677f\u529f\u80fd\u5f00\u53d1/\u7b14\u8bb0.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u77ed\u4fe1\u4e0e\u5185\u5bb9\u5ba1\u67e5\u6280\u672f\u8c03\u7814",permalink:"/FED-DOC/docs/\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/\u7f16\u8f91\u5668/17\u5468 \u7f16\u8f91\u5668\u670d\u52a1\u7aef\u8c03\u7528\u7b2c\u4e09\u65b9\u670d\u52a1/\u77ed\u4fe1\u4e0e\u5185\u5bb9\u5ba1\u67e5\u6280\u672f\u8c03\u7814"},next:{title:"\u7b14\u8bb0",permalink:"/FED-DOC/docs/\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/\u7f16\u8f91\u5668/19\u5468 \u8ba9\u5143\u7d20\u52a8\u8d77\u6765 - \u7f16\u8f91\u5668\u753b\u5e03\u4ea4\u4e92\u529f\u80fd\u5f00\u53d1/\u7b14\u8bb0"}},s={},d=[{value:"\u5c06\u6536\u83b7\u4ec0\u4e48",id:"\u5c06\u6536\u83b7\u4ec0\u4e48",level:3},{value:"\u4e3b\u8981\u5185\u5bb9",id:"\u4e3b\u8981\u5185\u5bb9",level:3},{value:"\u5b66\u4e60\u65b9\u6cd5",id:"\u5b66\u4e60\u65b9\u6cd5",level:3},{value:"<strong>1. \u4f7f\u7528 CropperJs \u88c1\u526a\u5e93</strong>",id:"1-\u4f7f\u7528-cropperjs-\u88c1\u526a\u5e93",level:2},{value:"\u9009\u62e9\u56fe\u7247\u88c1\u526a\u5de5\u5177",id:"\u9009\u62e9\u56fe\u7247\u88c1\u526a\u5de5\u5177",level:3},{value:"\u5bfb\u627e\u5408\u9002\u5f00\u6e90\u5e93\u7684\u7ecf\u9a8c\u4e4b\u8c08",id:"\u5bfb\u627e\u5408\u9002\u5f00\u6e90\u5e93\u7684\u7ecf\u9a8c\u4e4b\u8c08",level:3},{value:"\u8003\u91cf\u4e00\u4e2a\u5f00\u6e90\u5e93\u662f\u5426\u7b26\u5408\u6807\u51c6",id:"\u8003\u91cf\u4e00\u4e2a\u5f00\u6e90\u5e93\u662f\u5426\u7b26\u5408\u6807\u51c6",level:3},{value:"\u521d\u59cb\u5316 Cropper \u533a\u57df",id:"\u521d\u59cb\u5316-cropper-\u533a\u57df",level:3},{value:"\u65b9\u6cd5\u4e00\uff1a\u4f7f\u7528\u963f\u91cc\u4e91 OSS \u5b8c\u6210\u56fe\u7247\u88c1\u526a",id:"\u65b9\u6cd5\u4e00\u4f7f\u7528\u963f\u91cc\u4e91-oss-\u5b8c\u6210\u56fe\u7247\u88c1\u526a",level:3},{value:"\u4f7f\u7528 Cropper.js \u83b7\u53d6\u88c1\u526a\u56fe\u7247\u6570\u636e",id:"\u4f7f\u7528-cropperjs-\u83b7\u53d6\u88c1\u526a\u56fe\u7247\u6570\u636e",level:3},{value:"<strong>2. \u5206\u6790\u56fe\u5c42\u8bbe\u7f6e\u7684\u9700\u6c42\u548c\u5b9e\u73b0</strong>",id:"2-\u5206\u6790\u56fe\u5c42\u8bbe\u7f6e\u7684\u9700\u6c42\u548c\u5b9e\u73b0",level:2},{value:"\u56fe\u5c42\u5c5e\u6027\u9700\u6c42\u5206\u6790",id:"\u56fe\u5c42\u5c5e\u6027\u9700\u6c42\u5206\u6790",level:3},{value:"\u56fe\u5c42\u9501\u5b9a\u548c\u9690\u85cf/\u663e\u793a\u4ee5\u53ca\u70b9\u51fb\u9009\u4e2d",id:"\u56fe\u5c42\u9501\u5b9a\u548c\u9690\u85cf\u663e\u793a\u4ee5\u53ca\u70b9\u51fb\u9009\u4e2d",level:3},{value:"\u56fe\u5c42\u540d\u79f0\u7f16\u8f91",id:"\u56fe\u5c42\u540d\u79f0\u7f16\u8f91",level:3},{value:"\u62d6\u52a8\u6539\u53d8\u987a\u5e8f",id:"\u62d6\u52a8\u6539\u53d8\u987a\u5e8f",level:3},{value:"\u56fe\u5c42\u5217\u8868\u8bbe\u7f6e\u9501\u5b9a",id:"\u56fe\u5c42\u5217\u8868\u8bbe\u7f6e\u9501\u5b9a",level:3},{value:"\u56fe\u5c42\u5217\u8868\u8bbe\u7f6e\u9009\u4e2d",id:"\u56fe\u5c42\u5217\u8868\u8bbe\u7f6e\u9009\u4e2d",level:3},{value:"\u56fe\u5c42\u5217\u8868\u8bbe\u7f6e\u9690\u85cf/\u663e\u793a",id:"\u56fe\u5c42\u5217\u8868\u8bbe\u7f6e\u9690\u85cf\u663e\u793a",level:3},{value:"\u56fe\u5c42\u91cd\u547d\u540d",id:"\u56fe\u5c42\u91cd\u547d\u540d",level:3},{value:"InLineEdit\u7ec4\u4ef6",id:"inlineedit\u7ec4\u4ef6",level:3},{value:"\u77e5\u8bc6\u70b9",id:"\u77e5\u8bc6\u70b9",level:3},{value:"\u5199\u6d4b\u8bd5\u7528\u4f8b",id:"\u5199\u6d4b\u8bd5\u7528\u4f8b",level:3},{value:"useKeyPress.ts",id:"usekeypressts",level:3},{value:"useClickOutside.ts",id:"useclickoutsidets",level:2},{value:"InLineEdit.vue",id:"inlineeditvue",level:2},{value:"\u65b0\u7684\u5b66\u4e60\u65b9\u6cd5",id:"\u65b0\u7684\u5b66\u4e60\u65b9\u6cd5",level:3},{value:"\u4ece\u4e24\u4e2a demo \u5f00\u59cb",id:"\u4ece\u4e24\u4e2a-demo-\u5f00\u59cb",level:3},{value:"\u5217\u8868\u6392\u5e8f\u7684\u4e09\u4e2a\u9636\u6bb5",id:"\u5217\u8868\u6392\u5e8f\u7684\u4e09\u4e2a\u9636\u6bb5",level:3},{value:"\u7b2c\u4e00\u9636\u6bb5 Dragstart",id:"\u7b2c\u4e00\u9636\u6bb5-dragstart",level:2},{value:"\u539f\u751f\u62d6\u62fd\u4e8b\u4ef6\u5b9e\u73b0",id:"\u539f\u751f\u62d6\u62fd\u4e8b\u4ef6\u5b9e\u73b0",level:2}],c={toc:d};function m(e){var n=e.components,o=(0,l.Z)(e,i);return(0,r.kt)("wrapper",(0,a.Z)({},c,o,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"\u6b22\u8fce\u5927\u5bb6\u56de\u5230B\u7aef\u9879\u76ee\u7684\u5f00\u53d1\uff0c\u8fd9\u5468\u8ba9\u6211\u4eec\u7740\u773c\u4e8e\u7f16\u8f91\u5668\u53f3\u4fa7\u8bbe\u7f6e\u90e8\u5206\u7684\u7f16\u7801\u5de5\u4f5c\uff0c\u5b8c\u6210\u7ec4\u4ef6\u5c5e\u6027\u8bbe\u7f6e\uff0c\u56fe\u5c42\u8bbe\u7f6e\uff0c\u4ee5\u53ca\u9875\u9762\u8bbe\u7f6e\u7684\u4e00\u7cfb\u5217\u529f\u80fd\u3002\u4e3a\u4e86\u4e0d\u8ba9\u5927\u5bb6\u9677\u5165\u4e1a\u52a1\u7684\u6ce5\u6f6d\u4e2d\uff0c\u4f1a\u6311\u9009\u5178\u578b\u7684\u51e0\u4e2a\u4e1a\u52a1\u548c\u77e5\u8bc6\u70b9\u8bb2\u884c\u8bb2\u672f\u548c\u5f00\u53d1"),(0,r.kt)("h3",{id:"\u5c06\u6536\u83b7\u4ec0\u4e48"},"\u5c06\u6536\u83b7\u4ec0\u4e48"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u88c1\u526a\u56fe\u7247\u7684\u5b9e\u73b0")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u501f\u52a9\u963f\u91cc\u4e91OSS\u7684\u56fe\u7247\u5904\u7406"),(0,r.kt)("li",{parentName:"ul"},"\u91cd\u65b0\u83b7\u53d6\u88c1\u526a\u7684\u56fe\u7247\u6570\u636e\u5e76\u4e14\u91cd\u65b0\u4e0a\u4f20"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u521b\u5efaVue3\u94a9\u5b50\u51fd\u6570\u7684\u539f\u5219")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u62d6\u52a8\u6392\u5e8f\u7684\u5b9e\u73b0\u539f\u7406")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u590d\u6742\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5206\u6790\u8fc7\u7a0b"))),(0,r.kt)("h3",{id:"\u4e3b\u8981\u5185\u5bb9"},"\u4e3b\u8981\u5185\u5bb9"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u4f7f\u7528Cropper.js \u5b8c\u6210\u56fe\u7247\u88c1\u526a\u529f\u80fd"),(0,r.kt)("li",{parentName:"ul"},"\u521b\u5efaLayerList\u7ec4\u4ef6\u4ee5\u53ca\u5b8c\u6210InlineEdit \u7ec4\u4ef6\u7684\u7f16\u7801"),(0,r.kt)("li",{parentName:"ul"},"\u81ea\u7814\u4e00\u4e2a\u7b80\u5355\u7684\u5217\u8868\u62d6\u52a8\u65b9\u6848\uff0c\u4e86\u89e3\u539f\u7406\u540e\uff0c\u7136\u540e\u4f7f\u7528Vue Draggble Next\u8fdb\u884c\u66ff\u6362"),(0,r.kt)("li",{parentName:"ul"},"\u5b8c\u6210 EditGroup \u7684\u7f16\u7801\uff0c\u4e86\u89e3\u4f7f\u7528\u4f2a\u4ee3\u7801\u5206\u6790\u95ee\u9898\u7684\u8fc7\u7a0b"),(0,r.kt)("li",{parentName:"ul"},"\u5b8c\u6210BackgroundProcesser\u7ec4\u4ef6\uff0c\u5b66\u4e60\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5206\u6790\u8fc7\u7a0b")),(0,r.kt)("h3",{id:"\u5b66\u4e60\u65b9\u6cd5"},"\u5b66\u4e60\u65b9\u6cd5"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5148\u4e86\u89e3\u539f\u7406\uff0c\u81ea\u5df1\u7b80\u5355\u5b9e\u73b0\uff0c\u7136\u540e\u53ef\u4ee5\u4f7f\u7528\u6210\u719f\u7684\u7b2c\u4e09\u65b9\u5de5\u5177"),(0,r.kt)("li",{parentName:"ul"},"\u4f7f\u7528\u4f2a\u4ee3\u7801\u6216\u8005\u8d81\u624b\u7684\u7b2c\u4e09\u65b9\u5de5\u5177\uff0c\u5e2e\u52a9\u5b8c\u6210\u590d\u6742\u7684\u6570\u636e\u8f6c\u6362\u7684\u5206\u6790")),(0,r.kt)("h2",{id:"1-\u4f7f\u7528-cropperjs-\u88c1\u526a\u5e93"},(0,r.kt)("strong",{parentName:"h2"},"1. \u4f7f\u7528 CropperJs \u88c1\u526a\u5e93")),(0,r.kt)("h3",{id:"\u9009\u62e9\u56fe\u7247\u88c1\u526a\u5de5\u5177"},"\u9009\u62e9\u56fe\u7247\u88c1\u526a\u5de5\u5177"),(0,r.kt)("h3",{id:"\u5bfb\u627e\u5408\u9002\u5f00\u6e90\u5e93\u7684\u7ecf\u9a8c\u4e4b\u8c08"},"\u5bfb\u627e\u5408\u9002\u5f00\u6e90\u5e93\u7684\u7ecf\u9a8c\u4e4b\u8c08"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u4f7f\u7528google\u6216\u8005github \u6765\u641c\u7d22"),(0,r.kt)("li",{parentName:"ul"},"\u4f7f\u7528\u82f1\u6587\u4f5c\u4e3a\u5173\u952e\u8bcd")),(0,r.kt)("h3",{id:"\u8003\u91cf\u4e00\u4e2a\u5f00\u6e90\u5e93\u662f\u5426\u7b26\u5408\u6807\u51c6"},"\u8003\u91cf\u4e00\u4e2a\u5f00\u6e90\u5e93\u662f\u5426\u7b26\u5408\u6807\u51c6"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"star \u6570\u91cf"),(0,r.kt)("li",{parentName:"ul"},"issue\u6570\u91cf"),(0,r.kt)("li",{parentName:"ul"},"releases\u6d3b\u8dc3\u5ea6"),(0,r.kt)("li",{parentName:"ul"},"\u67e5\u770b\u5b83\u7684DEMO")),(0,r.kt)("h3",{id:"\u521d\u59cb\u5316-cropper-\u533a\u57df"},"\u521d\u59cb\u5316 Cropper \u533a\u57df"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'<a-modal\n  :width="1000"\n  title="\u88c1\u526a\u56fe\u7247"\n  v-model:visible="showModal"\n  @ok="handleOk"\n  @cancel="showModal = false"\n  okText="\u786e\u8ba4"\n  cancelText="\u53d6\u6d88">\n  <div class="image-cropper">\n    <img id="processed-image" ref="cropperImageRef" :src="baseImageUrl" alt="">\n  </div>\n</a-modal>\n\n<a-button @click="showModal = true"> \n  <template v-slot:icon><ScissorOutlined /></template>\u88c1\u526a\u56fe\u7247\n</a-button>\n<a-button v-if="showDelete" type="danger" @click="handleDelete">\n  <template v-slot:icon><DeleteOutlined /></template>\u5220\u9664\u56fe\u7247\n</a-button>\n\n\nconst showModal = ref(false)\nconst backgroundUrl = computed(()=>`url(${props.value})`)\nconst baseImageUrl = computed(()=> props.value.split(\'?\')[0])\nconst cropperImageRef = ref<null|HTMLImageElement>(null)\nlet cropper: Cropper;\nlet cropData: CropDataProps | null = null;\nwatch(showModal, async(newValue)=>{\n  if(newValue) {\n    // \u7b49\u5f85 dom \u52a0\u8f7d\u5b8c\u518d\u83b7\u53d6\n    await nextTick()\n    console.log(cropperImageRef.value);\n    \n  }else {\n    cropper && cropper.destroy()\n  }\n})\nconst handleOk = () => {\n  showModal.value = false\n}\n')),(0,r.kt)("h3",{id:"\u65b9\u6cd5\u4e00\u4f7f\u7528\u963f\u91cc\u4e91-oss-\u5b8c\u6210\u56fe\u7247\u88c1\u526a"},"\u65b9\u6cd5\u4e00\uff1a\u4f7f\u7528\u963f\u91cc\u4e91 OSS \u5b8c\u6210\u56fe\u7247\u88c1\u526a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"watch(showModal, async(newValue)=>{\n  if(newValue) {\n    // \u7b49\u5f85 dom \u52a0\u8f7d\u5b8c\u518d\u83b7\u53d6\n    await nextTick()\n    console.log(cropperImageRef.value);\n    if(cropperImageRef.value){\n      cropper = new Cropper(cropperImageRef.value, {\n        // aspectRatio: 16 / 9,\n        crop(event) {\n          console.log(event.detail);\n          const {x,y,width,height} = event.detail\n          cropData = {\n            x: Math.floor(x),\n            y: Math.floor(y),\n            width: Math.floor(width),\n            height: Math.floor(height),\n          }\n        },\n      });\n    }\n  }else {\n    cropper && cropper.destroy()\n  }\n})\nconst handleOk = () => {\n  if(cropData) {\n    const {x,y,width,height} = cropData\n    // \u4f7f\u7528\u963f\u91ccOSS\u88c1\u526a\u56fe\u7247\n    // \u6bcf\u6b21\u53ea\u80fd\u5bf9\u539f\u56fe\u8fdb\u884c\u88c1\u526a\uff0c\u5426\u5219\u5750\u6807\u4f4d\u7f6e\u4f1a\u53d1\u751f\u504f\u79fb\n    const cropperURL = `${baseImageUrl.value}?x-oss-process=image/crop,x_${x},y_${y},w_${width},h_${height}`\n    emit('change',cropperURL)\n  }\n  showModal.value = false\n}\n")),(0,r.kt)("h3",{id:"\u4f7f\u7528-cropperjs-\u83b7\u53d6\u88c1\u526a\u56fe\u7247\u6570\u636e"},"\u4f7f\u7528 Cropper.js \u83b7\u53d6\u88c1\u526a\u56fe\u7247\u6570\u636e"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5b9e\u4f8b\u4e0a\u7684\u4e00\u4e2a\u65b9\u6cd5 - getCroppedCanvas")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/fengyuanchen/cropperjs#getcontainerdata"},"https://github.com/fengyuanchen/cropperjs#getcontainerdata")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"HTMLCanvasElement")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/zh-TW/docs/Web/API/HTMLCanvasElement"},"https://developer.mozilla.org/zh-TW/docs/Web/API/HTMLCanvasElement")),(0,r.kt)("h2",{id:"2-\u5206\u6790\u56fe\u5c42\u8bbe\u7f6e\u7684\u9700\u6c42\u548c\u5b9e\u73b0"},(0,r.kt)("strong",{parentName:"h2"},"2. \u5206\u6790\u56fe\u5c42\u8bbe\u7f6e\u7684\u9700\u6c42\u548c\u5b9e\u73b0")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"img",src:t(47644).Z,width:"974",height:"225"})),(0,r.kt)("h3",{id:"\u56fe\u5c42\u5c5e\u6027\u9700\u6c42\u5206\u6790"},"\u56fe\u5c42\u5c5e\u6027\u9700\u6c42\u5206\u6790"),(0,r.kt)("h3",{id:"\u56fe\u5c42\u9501\u5b9a\u548c\u9690\u85cf\u663e\u793a\u4ee5\u53ca\u70b9\u51fb\u9009\u4e2d"},"\u56fe\u5c42\u9501\u5b9a\u548c\u9690\u85cf/\u663e\u793a\u4ee5\u53ca\u70b9\u51fb\u9009\u4e2d"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5728editor.ts\u7684store \u4e2d\u7684components\u6dfb\u52a0\u66f4\u591a\u6807\u8bc6\u7b26")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"{\n  ...\n    isLocked: boolean ;\n  isHidden : boolean ;\n}\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u70b9\u51fb\u6309\u94ae\u5207\u6362\u4e3a\u4e0d\u540c\u7684\u503c\uff0c\u4f7f\u7528\u8fd9\u4e2a\u503c\u5728\u9875\u9762\u4e0a\u505a\u5224\u65ad\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u70b9\u51fb\u9009\u4e2d,\u8bbe\u7f6ecurrentElement\u7684\u503c")),(0,r.kt)("h3",{id:"\u56fe\u5c42\u540d\u79f0\u7f16\u8f91"},"\u56fe\u5c42\u540d\u79f0\u7f16\u8f91"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u6dfb\u52a0\u66f4\u591a\u5c5e\u6027-layerName")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u70b9\u51fb\u56fe\u5c42\u540d\u79f0\u7684\u65f6\u5019\uff0c\u5728input\u548c\u666e\u901a\u6807\u7b7e\u4e4b\u95f4\u5207\u6362\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u6dfb\u52a0\u6309\u94ae\u54cd\u5e94-\u5bf9\u4e8eesc\u548center\u952e\u7684\u54cd\u5e94")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u53ef\u80fd\u62bd\u8c61\u4e00\u4e2a\u901a\u7528\u7684hooks\u51fd\u6570\u2013 useKeyPress"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u70b9\u51fb\u5230input\u5916\u90e8\u533a\u57df\u7684\u54cd\u5e94")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u53ef\u80fd\u62bd\u8c61\u4e00\u4e2a\u901a\u7528\u7684hooks\u51fd\u6570- useClickOutside")))),(0,r.kt)("h3",{id:"\u62d6\u52a8\u6539\u53d8\u987a\u5e8f"},"\u62d6\u52a8\u6539\u53d8\u987a\u5e8f"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u6700\u6709\u96be\u5ea6\u7684\u4e00\u4e2a\u9700\u6c42,\u6d89\u53ca\u5230\u4e00\u4e2a\u8f83\u590d\u6742\u7684\u4ea4\u4e92"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"\u6700\u7ec8\u76ee\u7684\u5176\u5b9e\u5c31\u662f\u6539\u53d8store\u4e2dcomponents \u6570\u7ec4\u7684\u987a\u5e8f")),(0,r.kt)("li",{parentName:"ul"},"\u5728\u8fd9\u5757\u529f\u80fd\u8fdb\u884c\u7f16\u7801\u7684\u65f6\u5019,\u518d\u5f00\u59cb\u8be6\u7ec6\u7684\u5206\u6790")),(0,r.kt)("h3",{id:"\u56fe\u5c42\u5217\u8868\u8bbe\u7f6e\u9501\u5b9a"},"\u56fe\u5c42\u5217\u8868\u8bbe\u7f6e\u9501\u5b9a"),(0,r.kt)("h3",{id:"\u56fe\u5c42\u5217\u8868\u8bbe\u7f6e\u9009\u4e2d"},"\u56fe\u5c42\u5217\u8868\u8bbe\u7f6e\u9009\u4e2d"),(0,r.kt)("h3",{id:"\u56fe\u5c42\u5217\u8868\u8bbe\u7f6e\u9690\u85cf\u663e\u793a"},"\u56fe\u5c42\u5217\u8868\u8bbe\u7f6e\u9690\u85cf/\u663e\u793a"),(0,r.kt)("h3",{id:"\u56fe\u5c42\u91cd\u547d\u540d"},"\u56fe\u5c42\u91cd\u547d\u540d"),(0,r.kt)("h3",{id:"inlineedit\u7ec4\u4ef6"},"InLineEdit\u7ec4\u4ef6"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u663e\u793a\u9ed8\u8ba4\u6587\u672c\u533a\u57df\uff0c\u70b9\u51fb\u4ee5\u540e\u663e\u793a\u4e3aInput"),(0,r.kt)("li",{parentName:"ul"},"Input\u4e2d\u7684\u503c\u663e\u793a\u4e3a\u6587\u672c\u4e2d\u7684\u503c"),(0,r.kt)("li",{parentName:"ul"},"\u66f4\u65b0\u503c\u4ee5\u540e\uff0c\u952e\u76d8\u4e8b\u4ef6- (useKeyPress)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u70b9\u51fb\u56de\u8f66\u4ee5\u540e\u6062\u590d\u6587\u672c\u533a\u57df\uff0c\u5e76\u4e14\u663e\u793a\u65b0\u7684\u503c"),(0,r.kt)("li",{parentName:"ul"},"\u70b9\u51fbESC\u540e\u6062\u590d\u6587\u672c\u533a\u57df\uff0c\u5e76\u4e14\u663e\u793a\u521a\u5f00\u59cb\u7684\u65e7\u7684\u503c"))),(0,r.kt)("li",{parentName:"ul"},"\u66f4\u65b0\u503c\u4ee5\u540e\uff0c\u70b9\u51fb\u4e8b\u4ef6- ( useCl ickOutside )"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u70b9\u51fbInput\u533a\u57df\u5916\u4fa7\u6062\u590d\u6587\u672c\u533a\u57df\uff0c\u5e76\u4e14\u663e\u793a\u65b0\u7684\u503c"))),(0,r.kt)("li",{parentName:"ul"},"\u7b80\u5355\u9a8c\u8bc1"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u5f53Input \u503c\u4e3a\u7a7a\u7684\u65f6\u5019\uff0c\u4e0d\u6062\u590d\uff0c\u5e76\u4e14\u663e\u793a\u9519\u8bef\u3002")))),(0,r.kt)("h3",{id:"\u77e5\u8bc6\u70b9"},"\u77e5\u8bc6\u70b9"),(0,r.kt)("p",null,"\u4f7f\u7528\u4e8b\u4ef6\u6d3e\u53d1enter\u4e8b\u4ef6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"const event = new KeyboardEvent('keydown', { key: 'Escape' })\ndocument.dispatchEvent(event)\n")),(0,r.kt)("h3",{id:"\u5199\u6d4b\u8bd5\u7528\u4f8b"},"\u5199\u6d4b\u8bd5\u7528\u4f8b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"import { mount, VueWrapper } from \"@vue/test-utils\";\nimport InlineEdit from \"@/components/InlineEdit.vue\";\nimport { nextTick } from 'vue'\nlet wrapper: VueWrapper<any>;\n\ndescribe(\"InlineEdit component\", () => {\n  beforeAll(() => {\n    wrapper = mount(InlineEdit, {\n      props: {\n        value: \"test\",\n      },\n      slots: {\n        default: '<template #default=\"{ text }\"><h2>{{text}}</h2></template>'\n      }\n    });\n  });\n\n  it('should render the default layout', () => {\n    expect(wrapper.get('h2').text()).toBe('test')\n  })\n  it('should render input when clicking the element', async () => {\n    await wrapper.trigger('click')\n    expect(wrapper.find('input').exists()).toBeTruthy()\n    const input = wrapper.get('input').element as HTMLInputElement;\n    expect(input.value).toBe('test')\n  })\n\n  it('press enter should render to default layout with new value', async () => {\n    const newText = 'testnew'\n    await wrapper.get('input').setValue(newText)\n    // \u5168\u5c40\u8c03\u7528\u4e8b\u4ef6\n    const event = new KeyboardEvent('keydown', { key: 'Enter' })\n    document.dispatchEvent(event)\n    await nextTick()\n    expect(wrapper.find('h2').exists()).toBeTruthy()\n    expect(wrapper.get('h2').text()).toBe(newText)\n    const events: any = wrapper.emitted('change')\n    expect(events[0]).toEqual([newText])\n  })\n\n  it('press esc should render to default layout with old value', async () => {\n    const newText = 'test123'\n    await wrapper.trigger('click')\n    await wrapper.get('input').setValue(newText)\n    const event = new KeyboardEvent('keydown', { key: 'Escape' })\n    document.dispatchEvent(event)\n    await nextTick()\n    expect(wrapper.find('h2').exists()).toBeTruthy()\n    expect(wrapper.get('h2').text()).toBe('testnew')\n  })\n\n  it('click outside should render to default layout with new value', async () => {\n    await wrapper.trigger('click')\n    await wrapper.get('input').setValue('testupdated')\n    const event = new MouseEvent('click')\n    document.dispatchEvent(event)\n    await nextTick()\n    expect(wrapper.find('h2').exists()).toBeTruthy()\n    expect(wrapper.get('h2').text()).toBe('testupdated')\n    const events: any = wrapper.emitted('change')\n    expect(events[1]).toEqual(['testupdated'])\n  })\n});\n")),(0,r.kt)("h3",{id:"usekeypressts"},"useKeyPress.ts"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"import { onMounted, onUnmounted } from 'vue';\nconst useKeyPress = (key: string, cb: () => any) => {\n  const trigger = (event: KeyboardEvent) => {\n    if (event.key === key) {\n      cb()\n    }\n  }\n  onMounted(() => {\n    document.addEventListener('keydown', trigger)\n  })\n  onUnmounted(() => {\n    document.removeEventListener('keydown', trigger)\n  })\n}\n\nexport default useKeyPress\n")),(0,r.kt)("h2",{id:"useclickoutsidets"},"useClickOutside.ts"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"import { ref, onMounted, onUnmounted, Ref } from 'vue';\n\n/**\n * \u70b9\u51fb\u5143\u7d20\u662f\u5426\u5728\u5f53\u524d\u533a\u57df\u5185\n * @param elementRef\n */\nconst useClickOutside = (elementRef: Ref<null | HTMLElement>) => {\n  const isClickOutside = ref(false); // \u662f\u5426\u70b9\u51fb\u4e86\u533a\u57df\u5916\n  const handler = (e: MouseEvent) => {\n    if (elementRef.value && e.target) {\n      // \u68c0\u67e5\u70b9\u51fb\u5143\u7d20\u662f\u5426\u5728\u5f53\u524d\u533a\u57df\u5185\n      // \u5305\u542b\u5728\u533a\u57df\u5185\n      // \u7c7b\u578b\u201cEventTarget\u201d\u7684\u53c2\u6570\u4e0d\u80fd\u8d4b\u7ed9\u7c7b\u578b\u201cNode\u201d\u7684\u53c2\u6570 \u53ef\u4ee5\u4f7f\u7528\u7c7b\u578b\u65ad\u8a00\uff0c\u628a\u7236\u7c7b\u65ad\u8a00\u6210\u5b50\u7c7b\n      if (elementRef.value.contains(e.target as HTMLElement)) {\n        isClickOutside.value = false\n      } else {\n        isClickOutside.value = true\n      }\n    }\n  }\n  onMounted(() => {\n    document.addEventListener('click', handler)\n  })\n  onUnmounted(() => {\n    document.removeEventListener('click', handler)\n  })\n  return isClickOutside\n}\n\nexport default useClickOutside\n")),(0,r.kt)("h2",{id:"inlineeditvue"},"InLineEdit.vue"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"\x3c!--  --\x3e\n<template>\n  <div class=\"inline-edit\" @click.stop=\"handleClick\" ref=\"wrapper\">\n    <input v-if=\"isEditing\" v-model=\"innerValue\" placeholder=\"\u6587\u672c\u4e0d\u80fd\u4e3a\u7a7a\" ref=\"inputRef\" />\n    <slot v-else :text=\"innerValue\">\n      <span>{{ innerValue }}</span>\n    </slot>\n  </div>\n</template>\n<script lang='ts'>\nimport { defineComponent, nextTick, ref, watch } from 'vue'\nimport useKeyPress from \"@/hooks/useKeyPress\";\nimport useClickOutside from \"@/hooks/useClickOutside\";\nexport default defineComponent({\n  name: 'inline-edit',\n  props: {\n    value: {\n      type: String,\n      requiered: true,\n    }\n  },\n  emits: ['change'],\n  setup(props, context) {\n    const innerValue = ref(props.value)\n    const wrapper = ref<null | HTMLElement>(null)\n    const inputRef = ref<null | HTMLInputElement>(null)\n    const isOutside = useClickOutside(wrapper)\n    let cachedOldValue = ''\n    const isEditing = ref(false)\n    const handleClick = () => {\n      isEditing.value = true\n    }\n    watch(isEditing, async (isEditing) => {\n      if (isEditing) {\n        cachedOldValue = innerValue.value || ''\n        await nextTick() // \u6b64\u65f6\u8fd8\u6ca1\u6709\u83b7\u53d6 dom \u8282\u70b9\n        if(inputRef.value) { // \u83b7\u53d6input\uff0c\u6dfb\u52a0\u805a\u7126\n          inputRef.value.focus()\n        }\n      }\n    })\n    watch(isOutside, (newValue) => {\n      if (newValue && isEditing.value) {\n        isEditing.value = false\n        context.emit('change', innerValue.value)\n      }\n      isOutside.value = false\n    })\n    useKeyPress('Enter', () => {\n      if (isEditing.value) {\n        isEditing.value = false\n        context.emit('change', innerValue.value)\n      }\n    })\n    useKeyPress('Escape', () => {\n      if (isEditing.value) {\n        isEditing.value = false\n        innerValue.value = cachedOldValue\n      }\n    })\n    return {\n      innerValue,\n      isEditing,\n      handleClick,\n      wrapper,\n      inputRef\n    };\n  }\n})\n<\/script>\n<style lang='scss' scoped>\n.inline-edit {\n  cursor: pointer;\n}\n.ant-input.input-error {\n  border: 1px solid #f5222d;\n}\n.ant-input.input-error:focus {\n  border-color:  #f5222d;\n}\n.ant-input.input-error::placeholder {\n  color: #f5222d;\n}\n</style>\n")),(0,r.kt)("h1",{id:"\u62d6\u62fd\u6392\u5e8f\u5217\u8868"},"\u62d6\u62fd\u6392\u5e8f\u5217\u8868"),(0,r.kt)("h3",{id:"\u65b0\u7684\u5b66\u4e60\u65b9\u6cd5"},"\u65b0\u7684\u5b66\u4e60\u65b9\u6cd5"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u7528\u624b\u5199\u7b80\u5355\u7684\u65b9\u6cd5\u5b9e\u73b0\u4e00\u4e2a\u529f\u80fd\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u7136\u540e\u4f7f\u7528\u6bd4\u8f83\u6210\u719f\u7684\u7b2c\u4e09\u65b9\u89e3\u51b3\u65b9\u6848\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u65e2\u80fd\u5b66\u4e60\u539f\u7406\u53c8\u80fd\u5b66\u4e60\u7b2c\u4e09\u65b9\u5e93\u7684\u4f7f\u7528\u3002")),(0,r.kt)("h3",{id:"\u4ece\u4e24\u4e2a-demo-\u5f00\u59cb"},"\u4ece\u4e24\u4e2a demo \u5f00\u59cb"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"vue Draggable Next: ",(0,r.kt)("a",{parentName:"li",href:"https://sortablejs.github.io/vue.draggable.next/#/simple"},"https://sortablejs.github.io/vue.draggable.next/#/simple")),(0,r.kt)("li",{parentName:"ul"},"React Sortable HoC: ",(0,r.kt)("a",{parentName:"li",href:"https://clauderic.github.io/react-sortable-hoc/"},"https://clauderic.github.io/react-sortable-hoc/"))),(0,r.kt)("h3",{id:"\u5217\u8868\u6392\u5e8f\u7684\u4e09\u4e2a\u9636\u6bb5"},"\u5217\u8868\u6392\u5e8f\u7684\u4e09\u4e2a\u9636\u6bb5"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u62d6\u52a8\u5f00\u59cb \uff08dargstart\uff09")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u88ab\u62d6\u52a8\u56fe\u5c42\u7684\u72b6\u6001\u53d8\u5316"),(0,r.kt)("li",{parentName:"ul"},"\u4f1a\u51fa\u73b0\u4e00\u4e2a\u6d6e\u5c42"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u62d6\u52a8\u8fdb\u884c\u4e2d\uff08dragmove\uff09")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u6d6e\u5c42\u4f1a\u968f\u7740\u9f20\u6807\u79fb\u52a8"),(0,r.kt)("li",{parentName:"ul"},"\u6761\u76ee\u53d1\u751f",(0,r.kt)("strong",{parentName:"li"},"\u6362\u4f4d\uff1a"),"\u5f53\u6d6e\u5c42\u4e0b\u6cbf\u8d85\u8fc7\u88ab\u62d6\u52a8\u6761\u76ee\u4e8c\u5206\u4e4b\u4e00\u7684\u65f6\u5019\uff0c\u89e6\u53d1\u6362\u4f4d"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u677e\u5f00\u9f20\u6807\u9636\u6bb5\uff08drop\uff09")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u6d6e\u5c42\u6d88\u5931"),(0,r.kt)("li",{parentName:"ul"},"\u88ab\u62d6\u52a8\u56fe\u5c42\u72b6\u6001\u8fd8\u539f"),(0,r.kt)("li",{parentName:"ul"},"\u6570\u636e\u88ab\u66f4\u65b0")))),(0,r.kt)("h2",{id:"\u7b2c\u4e00\u9636\u6bb5-dragstart"},"\u7b2c\u4e00\u9636\u6bb5 Dragstart"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u88ab\u62d6\u52a8\u56fe\u5c42\u7684\u72b6\u6001\u53d8\u5316 \u5e38\u89c4\u505a\u6cd5")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u6dfb\u52a0mouseDown\u4e8b\u4ef6\uff0c\u68c0\u67e5\u5f53\u524d\u7684 target\u662f\u54ea\u4e2a\u5143\u7d20\uff0c\u7136\u540e\u7ed9\u4ed6\u6dfb\u52a0\u7279\u5b9a\u7684\u72b6\u6001"),(0,r.kt)("li",{parentName:"ul"},"\u6dfb\u52a0mouseMove\u4e8b\u4ef6\uff0c\u521b\u5efa\u4e00\u4e2a\u548c\u88ab\u62d6\u52a8\u5143\u7d20\u4e00\u6478\u4e00\u6837\u7684\u6d6e\u5c42\uff0c\u5c06\u5b83\u7684\u5b9a\u4f4d\u8bbe\u7f6e\u4e3a\u7edd\u5bf9\u5b9a\u4f4d\uff0c\u5e76\u4e14\u968f\u7740\u9f20\u6807\u7684\u5750\u6807\u66f4\u65b0\u3002"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u4f7f\u7528 HTML \u7684 Drag \u7279\u6027")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/zh-CN/docs/Web/API/HTML_Drag_and_Drop_API/Drag_operations"},"https://developer.mozilla.org/zh-CN/docs/Web/API/HTML_Drag_and_Drop_API/Drag_operations"),"\t"),(0,r.kt)("li",{parentName:"ul"},"\u6d4f\u89c8\u5668\u7684\u9ed8\u8ba4\u62d6\u62fd\u884c\u4e3a:\u652f\u6301\u56fe\u50cf\uff0c\u94fe\u63a5\u548c\u9009\u62e9\u7684\u6587\u672c\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5176\u4ed6\u5143\u7d20\u9ed8\u8ba4\u60c5\u51b5\u662f\u4e0d\u53ef\u62d6\u62fd\u7684\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c\u60f3\u53ef\u4ee5\u62d6\u62fd\u53ef\u4ee5\u8bbe\u7f6e\u4e3adraggable = 'true"),(0,r.kt)("li",{parentName:"ul"},"\u4f7f\u7528dragstart \u4e8b\u4ef6\u76d1\u63a7\u62d6\u52a8\u5f00\u59cb,\u5e76\u8bbe\u7f6e\u5bf9\u5e94\u5c5e\u6027")))),(0,r.kt)("h2",{id:"\u539f\u751f\u62d6\u62fd\u4e8b\u4ef6\u5b9e\u73b0"},"\u539f\u751f\u62d6\u62fd\u4e8b\u4ef6\u5b9e\u73b0"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'\x3c!-- \u56fe\u5c42\u5217\u8868 --\x3e\n<template>\n  <ul\n    :list="list"\n    class="ant-list-items ant-list-bordered"\n    @drop="onDrop"\n    @dragover="onDragOver"\n  >\n    <li\n      class="ant-list-item"\n      v-for="(item,index) in list" :key="item.id"\n      :class="{active: item.id === selectedId, ghost: dragData.currentDragging === item.id}"\n      @click="handleClick(item.id)"\n      :data-index="index"\n      draggable="true"\n      @dragstart="onDragStart($event,item.id,index)"\n      @dragenter="onDragEnter($event, index)"\n    >\n      <a-tooltip :title="item.isHidden ? \'\u663e\u793a\' : \'\u9690\u85cf\'">\n        <a-button shape="circle" @click.stop="handleChange(item.id, \'isHidden\', !item.isHidden)">\n          <template v-slot:icon v-if="item.isHidden">\n            <EyeOutlined />\n          </template>\n          <template v-slot:icon v-else>\n            <EyeInvisibleOutlined />\n          </template>\n        </a-button>\n      </a-tooltip>\n      <a-tooltip :title="item.isLocked ? \'\u89e3\u9501\' : \'\u9501\u5b9a\'">\n        <a-button shape="circle" @click="handleChange(item.id,\'isLocked\', !item.isLocked)">\n          <template v-slot:icon v-if="item.isLocked">\n            <UnlockOutlined />\n          </template>\n          <template v-slot:icon v-else>\n            <LockOutlined />\n          </template>\n        </a-button>\n      </a-tooltip>\n      <inline-edit class="edit-area" :value="item.layerName" @change="(value) => {handleChange(item.id, \'layerName\', value)}"></inline-edit>\n    </li>\n  </ul>\n</template>\n\n<script lang=\'ts\'>\nimport { PropType, reactive } from \'vue\';\nimport { arrayMoveMutable } from \'array-move\'\nimport { EyeOutlined, EyeInvisibleOutlined, UnlockOutlined, LockOutlined } from "@ant-design/icons-vue";\nimport { ComponentData } from \'@/store/editor\';\nimport InlineEdit from \'@/components/InlineEdit.vue\'\nimport { getParentElement } from \'@/helper\';\n\nexport default {\n    name: \'\',\n    components: {\n        EyeOutlined, EyeInvisibleOutlined, UnlockOutlined, LockOutlined,InlineEdit\n    },\n    props: {\n        list: {\n            type: Array as PropType<ComponentData[]>,\n            required: true,\n        },\n        selectedId: {\n          type: String,\n          required: true,\n        }\n    },\n    emits: [\'select\', \'change\',\'drop\'],\n    setup(props:any, ctx:any) {\n      const dragData = reactive({\n        currentDragging: \'\',\n        currentIndex: -1\n      })\n      let start = -1\n      let end = -1\n      const handleClick = (id:string) => {\n        ctx.emit(\'select\',id)\n      }\n      const onDragStart = (e:DragEvent,id: string, index:number) => {\n        dragData.currentDragging = id\n        dragData.currentIndex = index\n        start = index\n      }\n      const onDragEnter = (e: DragEvent, index:number) => {\n        if(index !== dragData.currentIndex) {\n          console.log(\'enter\', index, dragData.currentIndex);\n          arrayMoveMutable(props.list, dragData.currentIndex, index) // \u4fee\u6539\u539f\u6570\u7ec4\n          dragData.currentIndex = index\n          end = index\n        }\n      }\n      const onDrop = (e:DragEvent) =>{\n        ctx.emit(\'drop\',{start,end})\n        dragData.currentDragging = \'\'\n      }\n      const onDragOver = (e:DragEvent) =>{\n        e.preventDefault()\n      }\n      const handleChange = (id: string,key: string,value: boolean) => {\n        const data = {\n          id,\n          key,\n          value,\n          isRoot: true\n        }\n        ctx.emit(\'change\',data)\n      }\n\n      return {\n        handleChange,\n        handleClick,\n        onDragStart,\n        dragData,\n        onDrop,\n        onDragOver,\n        onDragEnter\n      }\n    }\n}\n<\/script>\n<style lang=\'scss\' scoped>\n.ant-list-item {\n  padding: 10px 15px;\n  transition: all 0.5s ease-out;\n  cursor: pointer;\n  justify-content:normal;\n  border: 1px solid #fff;\n  border-bottom-color: #f0f0f0;\n  &.ghost {\n    opacity: 0.5;\n  }\n}\n.ant-list-item.active {\n  border: 1px solid #1890ff;\n}\n.ant-list-item:hover {\n  background:#e6f7ff\n}\n.ant-list-item>* {\n  margin-right: 10px;\n}\n.ant-list-item button {\n  font-size: 12px;\n}\n</style>\n\n')))}m.isMDXComponent=!0},47644:function(e,n,t){n.Z=t.p+"assets/images/1635928563528-0c8463a6-a511-4866-b2a2-a432f61851d1-4028b28aa499c7f93983d1a27e7ce65c.png"}}]);