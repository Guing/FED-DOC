"use strict";(self.webpackChunkfed_doc=self.webpackChunkfed_doc||[]).push([[4170],{3905:function(e,n,t){t.d(n,{Zo:function(){return p},kt:function(){return d}});var r=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var c=r.createContext({}),l=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=l(e.components);return r.createElement(c.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),m=l(t),d=o,f=m["".concat(c,".").concat(d)]||m[d]||u[d]||a;return t?r.createElement(f,i(i({ref:n},p),{},{components:t})):r.createElement(f,i({ref:n},p))}));function d(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,i=new Array(a);i[0]=m;var s={};for(var c in n)hasOwnProperty.call(n,c)&&(s[c]=n[c]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var l=2;l<a;l++)i[l]=t[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},47523:function(e,n,t){t.r(n),t.d(n,{assets:function(){return p},contentTitle:function(){return c},default:function(){return d},frontMatter:function(){return s},metadata:function(){return l},toc:function(){return u}});var r=t(87462),o=t(63366),a=(t(67294),t(3905)),i=["components"],s={},c="1. \u811a\u624b\u67b6\u5f00\u53d1\u81ea\u5b9a\u4e49\u6a21\u7248\u903b\u8f91",l={unversionedId:"\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/6\u5468 \u811a\u624b\u67b6\u521b\u5efa\u9879\u76ee\u548c\u7ec4\u4ef6\u521d\u59cb\u5316\u5f00\u53d1/\u811a\u624b\u67b6\u81ea\u5b9a\u4e49\u521d\u59cb\u5316\u9879\u76ee\u6a21\u677f\u529f\u80fd\u5f00\u53d1",id:"\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/6\u5468 \u811a\u624b\u67b6\u521b\u5efa\u9879\u76ee\u548c\u7ec4\u4ef6\u521d\u59cb\u5316\u5f00\u53d1/\u811a\u624b\u67b6\u81ea\u5b9a\u4e49\u521d\u59cb\u5316\u9879\u76ee\u6a21\u677f\u529f\u80fd\u5f00\u53d1",title:"1. \u811a\u624b\u67b6\u5f00\u53d1\u81ea\u5b9a\u4e49\u6a21\u7248\u903b\u8f91",description:"- \u53d1\u5e03\u81ea\u5b9a\u4e49\u6a21\u7248 cli-dev-zy-template-custom-vue2",source:"@site/docs/19-\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/6\u5468 \u811a\u624b\u67b6\u521b\u5efa\u9879\u76ee\u548c\u7ec4\u4ef6\u521d\u59cb\u5316\u5f00\u53d1/04-\u811a\u624b\u67b6\u81ea\u5b9a\u4e49\u521d\u59cb\u5316\u9879\u76ee\u6a21\u677f\u529f\u80fd\u5f00\u53d1.md",sourceDirName:"19-\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/6\u5468 \u811a\u624b\u67b6\u521b\u5efa\u9879\u76ee\u548c\u7ec4\u4ef6\u521d\u59cb\u5316\u5f00\u53d1",slug:"/\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/6\u5468 \u811a\u624b\u67b6\u521b\u5efa\u9879\u76ee\u548c\u7ec4\u4ef6\u521d\u59cb\u5316\u5f00\u53d1/\u811a\u624b\u67b6\u81ea\u5b9a\u4e49\u521d\u59cb\u5316\u9879\u76ee\u6a21\u677f\u529f\u80fd\u5f00\u53d1",permalink:"/FED-DOC/docs/\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/6\u5468 \u811a\u624b\u67b6\u521b\u5efa\u9879\u76ee\u548c\u7ec4\u4ef6\u521d\u59cb\u5316\u5f00\u53d1/\u811a\u624b\u67b6\u81ea\u5b9a\u4e49\u521d\u59cb\u5316\u9879\u76ee\u6a21\u677f\u529f\u80fd\u5f00\u53d1",editUrl:"https://github.com/Guing/FED-DOC/docs/19-\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/6\u5468 \u811a\u624b\u67b6\u521b\u5efa\u9879\u76ee\u548c\u7ec4\u4ef6\u521d\u59cb\u5316\u5f00\u53d1/04-\u811a\u624b\u67b6\u81ea\u5b9a\u4e49\u521d\u59cb\u5316\u9879\u76ee\u6a21\u677f\u529f\u80fd\u5f00\u53d1.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"ejs\u7528\u6cd5",permalink:"/FED-DOC/docs/\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/6\u5468 \u811a\u624b\u67b6\u521b\u5efa\u9879\u76ee\u548c\u7ec4\u4ef6\u521d\u59cb\u5316\u5f00\u53d1/ejs\u548cglob\u7528\u6cd5\u8be6\u89e3"},next:{title:"1. ejs.compile\u6267\u884c\u6d41\u7a0b\u5206\u6790",permalink:"/FED-DOC/docs/\u4f53\u7cfb/\u6155\u8bfe\u7f51\u524d\u7aef\u67b6\u6784\u5e08/6\u5468 \u811a\u624b\u67b6\u521b\u5efa\u9879\u76ee\u548c\u7ec4\u4ef6\u521d\u59cb\u5316\u5f00\u53d1/ejs \u5e93\u6e90\u7801\u89e3\u6790 \u5f7b\u5e95\u641e\u61c2\u6a21\u677f\u52a8\u6001\u6e32\u67d3\u539f\u7406"}},p={},u=[],m={toc:u};function d(e){var n=e.components,t=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,r.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"1-\u811a\u624b\u67b6\u5f00\u53d1\u81ea\u5b9a\u4e49\u6a21\u7248\u903b\u8f91"},"1. \u811a\u624b\u67b6\u5f00\u53d1\u81ea\u5b9a\u4e49\u6a21\u7248\u903b\u8f91"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"async installCustomlTemplate() {\n    // \u67e5\u8be2\u81ea\u5b9a\u4e49\u6a21\u677f\u7684\u5165\u53e3\u6587\u4ef6\n    if (await this.templateNpm.exists()) {\n        const rootFile = this.templateNpm.getRootFilePath();\n        if (fs.existsSync(rootFile)) {\n            log.notice('\u5f00\u59cb\u6267\u884c\u81ea\u5b9a\u4e49\u6a21\u677f');\n            const templatePath = path.resolve(this.templateNpm.cacheFilePath, 'template');\n            const options = {\n                templateInfo: this.templateInfo,\n                projectInfo: this.projectInfo,\n                sourcePath: templatePath,\n                targetPath: process.cwd(),\n            };\n            // \u6267\u884c\u81ea\u5b9a\u4e49\u6a21\u7248\u4e2dmain\u6307\u5411\u7684\u6587\u4ef6\n            const code = `require('${rootFile}')(${JSON.stringify(options)})`;\n            log.verbose('code', code);\n            await execAsync('node', ['-e', code], { stdio: 'inherit', cwd: process.cwd() });\n            log.success('\u81ea\u5b9a\u4e49\u6a21\u677f\u5b89\u88c5\u6210\u529f');\n        } else {\n            throw new Error('\u81ea\u5b9a\u4e49\u6a21\u677f\u5165\u53e3\u6587\u4ef6\u4e0d\u5b58\u5728\uff01');\n        }\n    }\n}\n")),(0,a.kt)("h1",{id:"2-\u81ea\u5b9a\u4e49\u9879\u76ee\u6a21\u677f\u5f00\u53d1"},"2. \u81ea\u5b9a\u4e49\u9879\u76ee\u6a21\u677f\u5f00\u53d1"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u53d1\u5e03\u81ea\u5b9a\u4e49\u6a21\u7248 ",(0,a.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/liugezhou-cli-dev-template-custom-vue2"},"cli-dev-zy-template-custom-vue2")),(0,a.kt)("li",{parentName:"ul"},"mongodb\u4e2d\u914d\u7f6e\u81ea\u5b9a\u4e49\u6a21\u7248\u6570\u636e\u3002")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'{\n    "_id" : ObjectId("60dd5af21f683b5c176f0b4e"),\n    "name" : "vue2\u81ea\u5b9a\u4e49\u6a21\u677f",\n    "npmName" : "cli-dev-zy-template-custom-vue2",\n    "version" : "1.0.0",\n    "type" : "custom",\n    "installCommand" : "npm install --registry=https://registry.npm.taobao.org",\n    "startCommand" : "npm run serve",\n    "tag" : [ \n        "project"\n    ],\n    "ignore" : [ \n        "**/public/**"\n    ]\n}\n')),(0,a.kt)("h1",{id:"2-\u81ea\u5b9a\u4e49\u6a21\u677f\u6267\u884c\u903b\u8f91\u5f00\u53d1"},"2. \u81ea\u5b9a\u4e49\u6a21\u677f\u6267\u884c\u903b\u8f91\u5f00\u53d1"),(0,a.kt)("p",null,"\u5728\u81ea\u5b9a\u4e49\u6a21\u677f\u4e2d\u6dfb\u52a0 index.js \u6587\u4ef6\uff0cpackage.json\u6307\u5411\u8fd9\u4e2a\u6587\u4ef6"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"index.js")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const path = require('path')\nconst fse = require('fs-extra');\nconst inquirer = require('inquirer');\nconst glob = require('glob');\nconst ejs = require('ejs');\n\nasync function ejsRender(options) {\n  const dir = options.targetPath;\n  const projectInfo = options.data;\n  return new Promise((resolve, reject) => {\n    glob('**', {\n      cwd: dir,\n      ignore: options.ignore || '',\n      nodir: true,\n    }, function (err, files) {\n      if (err) {\n        reject(err);\n      }\n      Promise.all(files.map(file => {\n        const filePath = path.join(dir, file);\n        return new Promise((resolve1, reject1) => {\n          ejs.renderFile(filePath, projectInfo, {}, (err, result) => {\n            if (err) {\n              reject1(err);\n            } else {\n              fse.writeFileSync(filePath, result);\n              resolve1(result);\n            }\n          });\n        });\n      })).then(() => {\n        resolve();\n      }).catch(err => {\n        reject(err);\n      });\n    });\n  });\n}\n\nasync function install(options) {\n  const projectPrompt = [];\n  const descriptionPrompt = {\n    type: 'input',\n    name: 'description',\n    message: '\u8bf7\u8f93\u5165\u9879\u76ee\u63cf\u8ff0\u4fe1\u606f',\n    default: '',\n    validate: function (v) {\n      const done = this.async();\n      setTimeout(function () {\n        if (!v) {\n          done('\u8bf7\u8f93\u5165\u9879\u76ee\u63cf\u8ff0\u4fe1\u606f');\n          return;\n        }\n        done(null, true);\n      }, 0);\n    },\n  };\n  projectPrompt.push(descriptionPrompt);\n  const projectInfo = await inquirer.prompt(projectPrompt);\n  options.projectInfo.description = projectInfo.description;\n  try {\n    const { sourcePath, targetPath } = options;\n    fse.ensureDirSync(sourcePath)\n    fse.ensureDirSync(targetPath)\n    fse.copySync(sourcePath, targetPath)\n    // \u52a8\u6001\u914d\u7f6eignore\n    const templateIgnore = options.templateInfo.ignore || []\n    const ignore = ['**/node_modules/**', ...templateIgnore]\n    await ejsRender({ ignore, targetPath, data: options.projectInfo })\n    // const { installCommand, startCommand } = this.templateInfo\n    // \u4f9d\u8d56\u5b89\u88c5\n    // await this.execCommand(installCommand, '\u4f9d\u8d56\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u5931\u8d25!')\n    // \u542f\u52a8\u547d\u4ee4\u6267\u884c\n    // await this.execCommand(startCommand, '\u6267\u884c\u542f\u52a8\u547d\u4ee4\u5931\u8d25!')\n  } catch (e) {\n    throw e\n  }\n\n}\n\nmodule.exports = install\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"package.json")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'{\n  "name": "cli-dev-zy-template-custom-vue2",\n  "version": "1.0.2",\n  "description": "",\n  "author": "",\n  "license": "ISC",\n  "main": "index.js",\n  "dependencies": {\n    "ejs": "^3.1.5",\n    "fs-extra": "^9.0.1",\n    "glob": "^7.1.6",\n    "inquirer": "^7.3.3"\n  }\n}\n')))}d.isMDXComponent=!0}}]);