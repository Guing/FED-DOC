 ![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.006.png)

|**ç›®å½• content**|**1![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.007.png)**|**TerserPluginä»£ç å‹ç¼©**|
| :- | - | - |
||**2![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.008.png)**|**Tree Shakingçš„å®ç°**|
||**3![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.009.png)**|**Scope Hoistingä½œç”¨**|
||**4![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.010.png)**|**HTTPæ–‡ä»¶å‹ç¼©ä¼ è¾“**|
||**5![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.011.png)**|**HTMLæ–‡ä»¶çš„å‹ç¼©**|
||**6![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.012.png)**|**webpackæ‰“åŒ…åˆ†æ**|

## **JSä»£ç å‹ç¼©**

### **Terserä»‹ç»å’Œå®‰è£…**

- ä»€ä¹ˆæ˜¯Terserå‘¢ï¼Ÿ
  - Terseræ˜¯ä¸€ä¸ªJavaScriptçš„è§£é‡Šï¼ˆParserï¼‰ã€Manglerï¼ˆç»è‚‰æœºï¼‰/Compressorï¼ˆå‹ç¼©æœºï¼‰çš„å·¥å…·é›†ï¼›
  - æ—©æœŸæˆ‘ä»¬ä¼šä½¿ç”¨ uglify-jsæ¥å‹ç¼©ã€ä¸‘åŒ–æˆ‘ä»¬çš„JavaScriptä»£ç ï¼Œä½†æ˜¯ç›®å‰å·²ç»ä¸å†ç»´æŠ¤ï¼Œå¹¶ä¸”ä¸æ”¯æŒES6+çš„è¯­æ³•ï¼›
  - Terseræ˜¯ä» uglify-es fork è¿‡æ¥çš„ï¼Œå¹¶ä¸”ä¿ç•™å®ƒåŸæ¥çš„å¤§éƒ¨åˆ†APIä»¥åŠé€‚é… uglify-eså’Œuglify-js@3ç­‰ï¼›

- **ä¹Ÿå°±æ˜¯è¯´ï¼ŒTerserå¯ä»¥å¸®åŠ©æˆ‘ä»¬å‹ç¼©ã€ä¸‘åŒ–æˆ‘ä»¬çš„ä»£ç ï¼Œè®©æˆ‘ä»¬çš„bundleå˜å¾—æ›´å°ã€‚**
- å› ä¸ºTerseræ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å·¥å…·ï¼Œæ‰€ä»¥å®ƒå¯ä»¥å•ç‹¬å®‰è£…ï¼š
- å…¨å±€å®‰è£…
  - `npm install terser -g`


- å±€éƒ¨å®‰è£…
  - `npm install terser -D`


### **å‘½ä»¤è¡Œä½¿ç”¨Terser**

- æˆ‘ä»¬å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨Terserï¼š
  - `terser [input files] [options]`


- ä¸¾ä¾‹è¯´æ˜
  - `terser js/file1.js -o foo.min.js -c -m `


- æˆ‘ä»¬è¿™é‡Œæ¥è®²è§£å‡ ä¸ªCompress optionå’ŒMangle(ä¹±ç ) optionï¼š
  - å› ä¸ºä»–ä»¬çš„é…ç½®éå¸¸å¤šï¼Œæˆ‘ä»¬ä¸å¯èƒ½ä¸€ä¸ªä¸ªè§£æï¼Œæ›´å¤šçš„æŸ¥çœ‹æ–‡æ¡£å³å¯ï¼›

- [https://github.com/terser/terser#compress-options](https://github.com/terser/terser#compress-options)
- [https://github.com/terser/terser#mangle-options](https://github.com/terser/terser#mangle-options)

### **Compresså’ŒMangleçš„options**

- **Compress optionï¼š**
  - arrowsï¼šclassæˆ–è€…objectä¸­çš„å‡½æ•°ï¼Œè½¬æ¢æˆç®­å¤´å‡½æ•°ï¼›
  - argumentsï¼šå°†å‡½æ•°ä¸­ä½¿ç”¨ arguments[index]è½¬æˆå¯¹åº”çš„å½¢å‚åç§°ï¼›
  - dead\_codeï¼šç§»é™¤ä¸å¯è¾¾çš„ä»£ç ï¼ˆtree shakingï¼‰ï¼›
  - å…¶ä»–å±æ€§å¯ä»¥æŸ¥çœ‹æ–‡æ¡£ï¼›

- **Mangle option**
  - toplevelï¼šé»˜è®¤å€¼æ˜¯falseï¼Œé¡¶å±‚ä½œç”¨åŸŸä¸­çš„å˜é‡åç§°ï¼Œè¿›è¡Œä¸‘åŒ–ï¼ˆè½¬æ¢ï¼‰ï¼›
  - keep\_classnamesï¼šé»˜è®¤å€¼æ˜¯falseï¼Œæ˜¯å¦ä¿æŒä¾èµ–çš„ç±»åç§°ï¼›
  - keep\_fnamesï¼šé»˜è®¤å€¼æ˜¯falseï¼Œæ˜¯å¦ä¿æŒåŸæ¥çš„å‡½æ•°åç§°ï¼›
  - å…¶ä»–å±æ€§å¯ä»¥æŸ¥çœ‹æ–‡æ¡£ï¼›


`npx terser ./src/abc.js -o abc.min.js -c arrows,arguments=true,dead\_code -m toplevel=true,keep\_classnames=true,keep\_fnames=true `

### **Terseråœ¨webpackä¸­é…ç½®**

- çœŸå®å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ‰‹åŠ¨çš„é€šè¿‡terseræ¥å¤„ç†æˆ‘ä»¬çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡webpackæ¥å¤„ç†ï¼š
  - **åœ¨webpackä¸­æœ‰ä¸€ä¸ªminimizerå±æ€§ï¼Œåœ¨productionæ¨¡å¼ä¸‹ï¼Œé»˜è®¤å°±æ˜¯ä½¿ç”¨TerserPluginæ¥å¤„ç†æˆ‘ä»¬çš„ä»£ç çš„**ï¼›
  - å¦‚æœæˆ‘ä»¬å¯¹é»˜è®¤çš„é…ç½®ä¸æ»¡æ„ï¼Œä¹Ÿå¯ä»¥è‡ªå·±æ¥åˆ›å»ºTerserPluginçš„å®ä¾‹ï¼Œå¹¶ä¸”è¦†ç›–ç›¸å…³çš„é…ç½®ï¼›

- **é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®minimizeä¸ºtrue**
  - è®©å…¶å¯¹æˆ‘ä»¬çš„ä»£ç è¿›è¡Œå‹ç¼©ï¼ˆé»˜è®¤productionæ¨¡å¼ä¸‹å·²ç»æ‰“å¼€äº†ï¼‰ 

- **å…¶æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨minimizeråˆ›å»ºä¸€ä¸ªTerserPluginï¼š** 
  - extractCommentsï¼šé»˜è®¤å€¼ä¸ºtrueï¼Œè¡¨ç¤ºä¼šå°†æ³¨é‡ŠæŠ½å–åˆ°ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­ï¼› 
    - åœ¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›ä¿ç•™è¿™ä¸ªæ³¨é‡Šæ—¶ï¼Œå¯ä»¥è®¾ç½®ä¸ºfalseï¼› 

  - parallelï¼šä½¿ç”¨å¤šè¿›ç¨‹å¹¶å‘è¿è¡Œæé«˜æ„å»ºçš„é€Ÿåº¦ï¼Œé»˜è®¤å€¼æ˜¯true 
    - å¹¶å‘è¿è¡Œçš„é»˜è®¤æ•°é‡ï¼š os.cpus().length - 1ï¼› 
    - æˆ‘ä»¬ä¹Ÿå¯ä»¥è®¾ç½®è‡ªå·±çš„ä¸ªæ•°ï¼Œä½†æ˜¯ä½¿ç”¨é»˜è®¤å€¼å³å¯ï¼› 

  - terserOptionsï¼šè®¾ç½®æˆ‘ä»¬çš„terserç›¸å…³çš„é…ç½® 
    - compressï¼šè®¾ç½®å‹ç¼©ç›¸å…³çš„é€‰é¡¹ï¼› 
    - mangleï¼šè®¾ç½®ä¸‘åŒ–ç›¸å…³çš„é€‰é¡¹ï¼Œå¯ä»¥ç›´æ¥è®¾ç½®ä¸ºtrueï¼› 
    - toplevelï¼šé¡¶å±‚å˜é‡æ˜¯å¦è¿›è¡Œè½¬æ¢ï¼› 
    - keep\_classnamesï¼šä¿ç•™ç±»çš„åç§°ï¼› 
    - keep\_fnamesï¼šä¿ç•™å‡½æ•°çš„åç§°ï¼› 


```js
 optimization: {
     minimize: true,
    // ä»£ç ä¼˜åŒ–: TerserPlugin => è®©ä»£ç æ›´åŠ ç®€å• => Terser
    minimizer: [
      // JSå‹ç¼©çš„æ’ä»¶: TerserPlugin
      new TerserPlugin({
        extractComments: false,
        terserOptions: {
          compress: {
            arguments: true,
            unused: true
          },
          mangle: true,
          // toplevel: false
          keep_fnames: true
        }
      }),
   
    ]
 }
```



## **CSSçš„å‹ç¼©**

- **å¦ä¸€ä¸ªä»£ç çš„å‹ç¼©æ˜¯CSSï¼š**
  - CSSå‹ç¼©é€šå¸¸æ˜¯å»é™¤æ— ç”¨çš„ç©ºæ ¼ç­‰ï¼Œå› ä¸ºå¾ˆéš¾å»ä¿®æ”¹é€‰æ‹©å™¨ã€å±æ€§çš„åç§°ã€å€¼ç­‰ï¼›
  - CSSçš„å‹ç¼©æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦å¤–ä¸€ä¸ªæ’ä»¶ï¼šcss-minimizer-webpack-pluginï¼›

- **css-minimizer-webpack-pluginæ˜¯ä½¿ç”¨cssnanoå·¥å…·æ¥ä¼˜åŒ–ã€å‹ç¼©CSSï¼ˆä¹Ÿå¯ä»¥å•ç‹¬ä½¿ç”¨ï¼‰ï¼›**
- ç¬¬ä¸€æ­¥ï¼Œå®‰è£… `css-minimizer-webpack-plugin`ï¼š
  - `npm install css-minimizer-webpack-plugin -D`


- ç¬¬äºŒæ­¥ï¼Œåœ¨optimization.minimizerä¸­é…ç½®

```js
optimization:{
  minimizer: [
     
      // CSSå‹ç¼©çš„æ’ä»¶: CSSMinimizerPlugin
      new CSSMinimizerPlugin({
         parallel: true
      })
    ]
}

```



## **Tree Shaking**

- ä»€ä¹ˆæ˜¯Tree Shakingå‘¢ï¼Ÿ
  - Tree Shakingæ˜¯ä¸€ä¸ªæœ¯è¯­ï¼Œåœ¨è®¡ç®—æœºä¸­è¡¨ç¤ºæ¶ˆé™¤æ­»ä»£ç ï¼ˆdead\_codeï¼‰ï¼›
  - æœ€æ—©çš„æƒ³æ³•èµ·æºäºLISPï¼Œç”¨äºæ¶ˆé™¤æœªè°ƒç”¨çš„ä»£ç ï¼ˆçº¯å‡½æ•°æ— å‰¯ä½œç”¨ï¼Œå¯ä»¥æ”¾å¿ƒçš„æ¶ˆé™¤ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¦æ±‚æˆ‘ä»¬åœ¨è¿›è¡Œå‡½æ•°å¼ ç¼–ç¨‹æ—¶ï¼Œå°½é‡ä½¿ç”¨çº¯å‡½æ•°çš„åŸå› ä¹‹ä¸€ï¼‰ï¼›
  - åæ¥Tree Shakingä¹Ÿè¢«åº”ç”¨äºå…¶ä»–çš„è¯­è¨€ï¼Œæ¯”å¦‚JavaScriptã€Dartï¼›

- JavaScriptçš„Tree Shakingï¼š
  - **å¯¹JavaScriptè¿›è¡ŒTree Shakingæ˜¯æºè‡ªæ‰“åŒ…å·¥å…·rollup**ï¼ˆåé¢æˆ‘ä»¬ä¹Ÿä¼šè®²çš„æ„å»ºå·¥å…·ï¼‰ï¼›
  - è¿™æ˜¯å› ä¸ºTree Shakingä¾èµ–äºES Moduleçš„é™æ€è¯­æ³•åˆ†æï¼ˆä¸æ‰§è¡Œä»»ä½•çš„ä»£ç ï¼Œå¯ä»¥æ˜ç¡®çŸ¥é“æ¨¡å—çš„ä¾èµ–å…³ç³»ï¼‰ï¼›
  - webpack2æ­£å¼å†…ç½®æ”¯æŒäº†ES2015æ¨¡å—ï¼Œå’Œæ£€æµ‹æœªä½¿ç”¨æ¨¡å—çš„èƒ½åŠ›ï¼›
  - **åœ¨webpack4æ­£å¼æ‰©å±•äº†è¿™ä¸ªèƒ½åŠ›ï¼Œå¹¶ä¸”é€šè¿‡ package.jsonçš„ sideEffectså±æ€§ä½œä¸ºæ ‡è®°ï¼Œå‘ŠçŸ¥webpackåœ¨ç¼–è¯‘æ—¶ï¼Œå“ªé‡Œæ–‡ ä»¶å¯ä»¥å®‰å…¨çš„åˆ é™¤æ‰ï¼›**
  - **webpack5ä¸­ï¼Œä¹Ÿæä¾›äº†å¯¹éƒ¨åˆ†CommonJSçš„tree shakingçš„æ”¯æŒï¼›**
  - [https://github.com/webpack/changelog-v5#commonjs-tree-shaking](https://github.com/webpack/changelog-v5#commonjs-tree-shaking)


### **webpackå®ç°Tree Shaking**

- äº‹å®ä¸Šwebpackå®ç°Tree Shakingé‡‡ç”¨äº†ä¸¤ç§ä¸åŒçš„æ–¹æ¡ˆï¼š
  - **usedExportsï¼šé€šè¿‡æ ‡è®°æŸäº›å‡½æ•°æ˜¯å¦è¢«ä½¿ç”¨ï¼Œä¹‹åé€šè¿‡Terseræ¥è¿›è¡Œä¼˜åŒ–çš„ï¼›**
    - å¯¼å…¥æ¨¡å—æ—¶, åˆ†ææ¨¡å—ä¸­çš„å“ªäº›å‡½æ•°æœ‰è¢«ä½¿ç”¨, å“ªäº›å‡½æ•°æ²¡æœ‰è¢«ä½¿ç”¨ã€‚
    - ç„¶åé€šè¿‡Terserå‹ç¼©åˆ é™¤æ‰

  - **sideEffectsï¼šè·³è¿‡æ•´ä¸ªæ¨¡å—/æ–‡ä»¶ï¼Œç›´æ¥æŸ¥çœ‹è¯¥æ–‡ä»¶æ˜¯å¦æœ‰å‰¯ä½œç”¨ï¼›**


![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.020.png)

### **usedExports**

- **å°†modeè®¾ç½®ä¸ºdevelopmentæ¨¡å¼ï¼š**
  - ä¸ºäº†å¯ä»¥çœ‹åˆ° usedExportså¸¦æ¥çš„æ•ˆæœï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ä¸º development æ¨¡å¼
  - å› ä¸ºåœ¨ production æ¨¡å¼ä¸‹ï¼Œwebpacké»˜è®¤çš„ä¸€äº›ä¼˜åŒ–ä¼šå¸¦æ¥å¾ˆå¤§çš„å½±å“ã€‚

- **è®¾ç½®usedExportsä¸ºtrueå’Œfalseå¯¹æ¯”æ‰“åŒ…åçš„ä»£ç ï¼š**
  - åœ¨usedExportsè®¾ç½®ä¸ºtrueæ—¶ï¼Œä¼šæœ‰ä¸€æ®µæ³¨é‡Šï¼šunused harmony export mulï¼›
  - è¿™æ®µæ³¨é‡Šçš„æ„ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå‘ŠçŸ¥Terseråœ¨ä¼˜åŒ–æ—¶ï¼Œå¯ä»¥åˆ é™¤æ‰è¿™æ®µä»£ç ï¼›


```js
  optimization: {
    // å¯¼å…¥æ¨¡å—æ—¶, åˆ†ææ¨¡å—ä¸­çš„å“ªäº›å‡½æ•°æœ‰è¢«ä½¿ç”¨, å“ªäº›å‡½æ•°æ²¡æœ‰è¢«ä½¿ç”¨.
    usedExports: true
  }
```

![æˆªå±2023-07-26 16.10.23](image/05_webpack%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88%EF%BC%88%E4%BA%8C%EF%BC%89/%E6%88%AA%E5%B1%8F2023-07-26%2016.10.23.png)

- **è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬æŠŠminimizeè®¾ç½®trueï¼š**
  - usedExportsè®¾ç½®ä¸ºtrueæ—¶ï¼Œmulå‡½æ•°è¢«é­”æ³•æ³¨é‡Šæ ‡è¯†ä¸ºæœªä½¿ç”¨ï¼Œæ‰€ä»¥terserä¼šæŠŠæœªä½¿ç”¨çš„mulå‡½æ•°åˆ é™¤æ‰ã€‚


```js
  optimization: {
    // å¯¼å…¥æ¨¡å—æ—¶, åˆ†ææ¨¡å—ä¸­çš„å“ªäº›å‡½æ•°æœ‰è¢«ä½¿ç”¨, å“ªäº›å‡½æ•°æ²¡æœ‰è¢«ä½¿ç”¨.
    minimize: true
  }
```

- **æ‰€ä»¥ï¼ŒusedExportså®ç°Tree Shakingæ˜¯ç»“åˆTerseræ¥å®Œæˆçš„ã€‚**
- **productionçš„æ¨¡å¼ä¸‹ï¼ŒusedExportsä¼šé»˜è®¤å¼€å¯**

### **sideEffects**

- **sideEffectsç”¨äºå‘ŠçŸ¥webpack compilerå“ªäº›æ¨¡å—æ—¶æœ‰å‰¯ä½œç”¨çš„ï¼š**
  - å‰¯ä½œç”¨çš„æ„æ€æ˜¯è¿™é‡Œé¢çš„ä»£ç æœ‰æ‰§è¡Œä¸€äº›ç‰¹æ®Šçš„ä»»åŠ¡ï¼Œä¸èƒ½ä»…ä»…é€šè¿‡exportæ¥åˆ¤æ–­è¿™æ®µä»£ç çš„æ„ä¹‰ï¼›

- **åœ¨package.jsonä¸­è®¾ç½®sideEffectsçš„å€¼ï¼š**
  - å¦‚æœæˆ‘ä»¬å°†sideEffectsè®¾ç½®ä¸ºfalseï¼Œå°±æ˜¯å‘ŠçŸ¥webpackå¯ä»¥å®‰å…¨çš„åˆ é™¤æœªç”¨åˆ°çš„exportsï¼›
  - å¦‚æœæœ‰ä¸€äº›æˆ‘ä»¬å¸Œæœ›ä¿ç•™ï¼Œå¯ä»¥è®¾ç½®ä¸ºæ•°ç»„ï¼›

- **ä¾‹å­**ï¼š
- ä¸€èˆ¬æˆ‘ä»¬åœ¨ä½¿ç”¨importå‡½æ•°å•çº¯å¯¼å…¥æ—¶ï¼Œä¸å¼•ç”¨ä»»ä½•ä¸œè¥¿æ—¶ï¼Œwebpackä¼šé»˜è®¤ä½¿ç”¨tree shakingï¼Œç”Ÿæˆçš„æ–‡ä»¶ä¸ä¼šæœ‰æœªä½¿ç”¨çš„å‡½æ•°
- ä½†æ˜¯è¿™ä¸ªæ–‡ä»¶è™½ç„¶æ˜¯ç©ºçš„ï¼Œè¿˜æ˜¯ä¼šç”Ÿæˆæ–‡ä»¶ã€‚

````js
//demo.js
export function parseLyric(lyricString) {
  return []
}

export function test() {
}


//main.js
import 'demo.js' //å¯¼å…¥ä½†æ˜¯æœªä½¿ç”¨

````

![æˆªå±2023-07-26 16.34.42](image/05_webpack%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88%EF%BC%88%E4%BA%8C%EF%BC%89/%E6%88%AA%E5%B1%8F2023-07-26%2016.34.42.png)

- è¿™é‡Œæˆ‘ä»¬åœ¨package.jsonï¼Œæ·»åŠ `sideEffects:false`ï¼Œæ ‡è¯†æ•´ä¸ªæ¨¡å—éƒ½æ˜¯æ²¡æœ‰ä½œç”¨çš„ã€‚é‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶å°±æ ¹æœ¬ä¸ä¼šç”Ÿæˆã€‚

  ![æˆªå±2023-07-26 16.37.26](image/05_webpack%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88%EF%BC%88%E4%BA%8C%EF%BC%89/%E6%88%AA%E5%B1%8F2023-07-26%2016.37.26.png)

- ä½†æ˜¯å¦‚æœdemo.jsé‡Œé¢æ˜¯æœ‰å‰¯ä½œç”¨çš„ï¼Œåˆ™ä»£ç ä¾ç„¶ä¼šè¢«åˆ é™¤æ‰ï¼Œä¼šå¯¼è‡´æŠ¥é”™ã€‚
- æ¯”å¦‚ä»¥ä¸‹çš„`window.lyric`çš„èµ‹å€¼è¢«åˆ é™¤æ‰äº†ï¼Œå¯¼è‡´å…¶ä»–jsä»£ç è®¿é—®æ—¶ï¼Œä¼šå‡ºé”™ã€‚

```js
//demo.js
export function parseLyric(lyricString) {
  return []
}

export function test() {
}


// æ¨¡å—çš„å‰¯ä½œç”¨ä»£ç ï¼Œä¿®æ”¹å…¨å±€å˜é‡ã€‚
window.lyric = "å“ˆå“ˆå“ˆå“ˆå“ˆ"
```

- è¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨package.jsonçš„sideEffectsè®¾ç½®ä¸ºæ•°ç»„ï¼Œæ·»åŠ ä¸€äº›æœ‰å‰¯ä½œç”¨çš„æ–‡ä»¶ã€‚

```json
{
  sideEffects:[
    "./src/demo.js"
  ]
}
```

- å¦‚æœä½¿ç”¨sideEffectsæ—¶ï¼Œå¦‚æœä½¿ç”¨import 'xxx.css'ï¼Œåˆ™cssä»£ç ä¹Ÿä¼šè¢«è®¤ä¸ºæ²¡æœ‰å‰¯ä½œç”¨ï¼Œä¼šè¢«åˆ é™¤æ‰ã€‚æ‰€ä»¥ä¹Ÿè¦åœ¨æ•°ç»„é‡Œæ·»åŠ cssæ–‡ä»¶ã€‚

```json
{
  sideEffects:[
    "./src/demo.js",
    "*.css"
  ]
}
```



### **Webpackä¸­tree shakingçš„è®¾ç½®**

- æ‰€ä»¥ï¼Œå¦‚ä½•åœ¨é¡¹ç›®ä¸­å¯¹JavaScriptçš„ä»£ç è¿›è¡ŒTreeShakingå‘¢ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰ï¼Ÿ
  - **åœ¨optimizationä¸­é…ç½®usedExportsä¸ºtrueï¼Œæ¥å¸®åŠ©Terserè¿›è¡Œä¼˜åŒ–ï¼›**
  - **åœ¨package.jsonä¸­é…ç½®sideEffectsï¼Œç›´æ¥å¯¹æ¨¡å—è¿›è¡Œä¼˜åŒ–ï¼›**


## **CSSå®ç°Tree Shaking**

- ä¸Šé¢æˆ‘ä»¬å­¦ä¹ çš„éƒ½æ˜¯å…³äºJavaScriptçš„Tree Shakingï¼Œé‚£ä¹ˆCSSæ˜¯å¦ä¹Ÿå¯ä»¥è¿›è¡ŒTree Shakingæ“ä½œå‘¢ï¼Ÿ
  - CSSçš„Tree Shakingéœ€è¦å€ŸåŠ©äºä¸€äº›å…¶ä»–çš„æ’ä»¶ï¼›
  - åœ¨æ—©æœŸçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨PurifyCssæ’ä»¶æ¥å®ŒæˆCSSçš„tree shakingï¼Œä½†æ˜¯ç›®å‰è¯¥åº“å·²ç»ä¸å†ç»´æŠ¤äº†ï¼ˆæœ€æ–°æ›´æ–°ä¹Ÿæ˜¯åœ¨4å¹´å‰ äº†ï¼‰ï¼›

- **ç›®å‰æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦å¤–ä¸€ä¸ªåº“æ¥å®ŒæˆCSSçš„Tree Shakingï¼šPurgeCSS**ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¸®åŠ©æˆ‘ä»¬åˆ é™¤æœªä½¿ç”¨çš„CSSçš„å·¥å…·ï¼›
- å®‰è£…PurgeCssçš„webpackæ’ä»¶ï¼š
  - `npm install purgecss-webpack-plugin -D`


### **é…ç½®PurgeCss**

- **é…ç½®è¿™ä¸ªæ’ä»¶ï¼ˆç”Ÿæˆç¯å¢ƒï¼‰ï¼š**
  - pathsï¼šè¡¨ç¤ºè¦æ£€æµ‹å“ªäº›ç›®å½•ä¸‹çš„å†…å®¹éœ€è¦è¢«åˆ†æï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨globï¼›
  - é»˜è®¤æƒ…å†µä¸‹ï¼ŒPurgecssä¼šå°†æˆ‘ä»¬çš„htmlæ ‡ç­¾çš„æ ·å¼ç§»é™¤æ‰ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›ä¿ç•™ï¼Œå¯ä»¥æ·»åŠ ä¸€ä¸ªsafelistçš„å±æ€§ï¼›


![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.024.png)

- **purgecssä¹Ÿå¯ä»¥å¯¹lessæ–‡ä»¶è¿›è¡Œå¤„ç†ï¼ˆæ‰€ä»¥å®ƒæ˜¯å¯¹æ‰“åŒ…åçš„cssè¿›è¡Œtree shakingæ“ä½œï¼‰ï¼›**

**Scope Hoisting**

- **ä»€ä¹ˆæ˜¯Scope Hoistingå‘¢ï¼Ÿ**
- Scope Hoistingä»webpack3å¼€å§‹å¢åŠ çš„ä¸€ä¸ªæ–°åŠŸèƒ½ï¼›
- åŠŸèƒ½æ˜¯å¯¹ä½œç”¨åŸŸè¿›è¡Œæå‡ï¼Œå¹¶ä¸”è®©webpackæ‰“åŒ…åçš„ä»£ç æ›´å°ã€è¿è¡Œæ›´å¿«ï¼›
- **é»˜è®¤æƒ…å†µä¸‹webpackæ‰“åŒ…ä¼šæœ‰å¾ˆå¤šçš„å‡½æ•°ä½œç”¨åŸŸï¼ŒåŒ…æ‹¬ä¸€äº›ï¼ˆæ¯”å¦‚æœ€å¤–å±‚çš„ï¼‰IIFEï¼š**
- æ— è®ºæ˜¯ä»æœ€å¼€å§‹çš„ä»£ç è¿è¡Œï¼Œè¿˜æ˜¯åŠ è½½ä¸€ä¸ªæ¨¡å—ï¼Œéƒ½éœ€è¦æ‰§è¡Œä¸€ç³»åˆ—çš„å‡½æ•°ï¼›
- Scope Hoistingå¯ä»¥å°†å‡½æ•°åˆå¹¶åˆ°ä¸€ä¸ªæ¨¡å—ä¸­æ¥è¿è¡Œï¼›
- **ä½¿ç”¨Scope Hoistingéå¸¸çš„ç®€å•ï¼Œwebpackå·²ç»å†…ç½®äº†å¯¹åº”çš„æ¨¡å—ï¼š**
- åœ¨productionæ¨¡å¼ä¸‹ï¼Œé»˜è®¤è¿™ä¸ªæ¨¡å—å°±ä¼šå¯ç”¨ï¼›
- åœ¨developmentæ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±æ¥æ‰“å¼€è¯¥æ¨¡å—ï¼›

![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.025.png)

**ä»€ä¹ˆæ˜¯HTTPå‹ç¼©ï¼Ÿ**

- **HTTPå‹ç¼©æ˜¯ä¸€ç§å†…ç½®åœ¨ æœåŠ¡å™¨ å’Œ å®¢æˆ·ç«¯ ä¹‹é—´çš„ï¼Œä»¥æ”¹è¿›ä¼ è¾“é€Ÿåº¦å’Œå¸¦å®½åˆ©ç”¨ç‡çš„æ–¹å¼ï¼›**
- **HTTPå‹ç¼©çš„æµç¨‹ä»€ä¹ˆå‘¢ï¼Ÿ**
- ç¬¬ä¸€æ­¥ï¼šHTTPæ•°æ®åœ¨æœåŠ¡å™¨å‘é€å‰å°±å·²ç»è¢«å‹ç¼©äº†ï¼›ï¼ˆå¯ä»¥åœ¨webpackä¸­å®Œæˆï¼‰
- ç¬¬äºŒæ­¥ï¼šå…¼å®¹çš„æµè§ˆå™¨åœ¨å‘æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œä¼šå‘ŠçŸ¥æœåŠ¡å™¨è‡ªå·±æ”¯æŒå“ªäº›å‹ç¼©æ ¼å¼ï¼›

![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.026.png)

- ç¬¬ä¸‰æ­¥ï¼šæœåŠ¡å™¨åœ¨æµè§ˆå™¨æ”¯æŒçš„å‹ç¼©æ ¼å¼ä¸‹ï¼Œç›´æ¥è¿”å›å¯¹åº”çš„å‹ç¼©åçš„æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨å“åº”å¤´ä¸­å‘ŠçŸ¥æµè§ˆå™¨ï¼›

![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.027.png)

**ç›®å‰çš„å‹ç¼©æ ¼å¼**

- **ç›®å‰çš„å‹ç¼©æ ¼å¼éå¸¸çš„å¤šï¼š**
- compress â€“ UNIXçš„â€œcompressâ€ç¨‹åºçš„æ–¹æ³•ï¼ˆå†å²æ€§åŸå› ï¼Œä¸æ¨èå¤§å¤šæ•°åº”ç”¨ä½¿ç”¨ï¼Œåº”è¯¥ä½¿ç”¨gzipæˆ–deflateï¼‰ï¼›
- deflate â€“ åŸºäºde[flateç®—æ³•ï¼ˆå®šä¹‰äº](https://zh.wikipedia.org/wiki/DEFLATE)RFC 1951ï¼‰çš„å‹ç¼©ï¼Œä½¿ç”¨zlibæ•°æ®æ ¼å¼å°è£…ï¼›
- gzip â€“ GNU zipæ ¼å¼ï¼ˆå®šä¹‰äºRFC 1952ï¼‰ï¼Œæ˜¯ç›®å‰ä½¿ç”¨æ¯”è¾ƒå¹¿æ³›çš„å‹ç¼©ç®—æ³•ï¼›
- br â€“ ä¸€ç§æ–°çš„å¼€æºå‹ç¼©ç®—æ³•ï¼Œä¸“ä¸ºHTTPå†…å®¹çš„ç¼–ç è€Œè®¾è®¡ï¼›

**Webpackå¯¹æ–‡ä»¶å‹ç¼©**

- **webpackä¸­ç›¸å½“äºæ˜¯å®ç°äº†HTTPå‹ç¼©çš„ç¬¬ä¸€æ­¥æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨CompressionPluginã€‚**
- **ç¬¬ä¸€æ­¥ï¼Œå®‰è£…CompressionPluginï¼š**

npm install compression-webpack-plugin -D![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.028.png)

- **ç¬¬äºŒæ­¥ï¼Œä½¿ç”¨CompressionPluginå³å¯ï¼š**

![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.029.png)

**HTMLæ–‡ä»¶ä¸­ä»£ç çš„å‹ç¼©**

- æˆ‘ä»¬ä¹‹å‰ä½¿ç”¨äº†**HtmlWebpackPlugin**
- **injectï¼šè®¾ç½®æ‰“åŒ…çš„èµ„æºæ’å…¥çš„ä½ç½®**
- trueã€ false ã€bodyã€head

æ’ä»¶æ¥ç”ŸæˆHTMLçš„æ¨¡æ¿ï¼Œäº‹å®ä¸Šå®ƒè¿˜æœ‰ä¸€äº›å…¶ä»–çš„é…ç½®ï¼š

- **cacheï¼šè®¾ç½®ä¸ºtrueï¼Œåªæœ‰å½“æ–‡ä»¶æ”¹å˜æ—¶ï¼Œæ‰ä¼šç”Ÿæˆæ–°çš„æ–‡ä»¶ï¼ˆé»˜è®¤å€¼ä¹Ÿæ˜¯trueï¼‰**
- **minifyï¼šé»˜è®¤ä¼šä½¿ç”¨ä¸€ä¸ªæ’ä»¶html-minifier-terser**

![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.030.jpeg)

**åˆ†æä¸€ï¼šæ‰“åŒ…çš„æ—¶é—´åˆ†æ**

- **å¦‚æœæˆ‘ä»¬å¸Œæœ›çœ‹åˆ°æ¯ä¸€ä¸ªloaderã€æ¯ä¸€ä¸ªPluginæ¶ˆè€—çš„æ‰“åŒ…æ—¶é—´ï¼Œå¯ä»¥å€ŸåŠ©äºä¸€ä¸ªæ’ä»¶ï¼š**
- æ³¨æ„ï¼šè¯¥æ’ä»¶åœ¨æœ€æ–°çš„webpackç‰ˆæœ¬ä¸­å­˜åœ¨ä¸€äº›å…¼å®¹æ€§çš„é—®é¢˜ï¼ˆå’Œéƒ¨åˆ†Pluginä¸å…¼å®¹ï¼‰
- æˆªæ­¢2021-3-10æ—¥ï¼Œä½†æ˜¯ç›®å‰è¯¥æ’ä»¶è¿˜åœ¨ç»´æŠ¤ï¼Œæ‰€ä»¥å¯ä»¥ç­‰å¾…åç»­æ˜¯å¦æ›´æ–°ï¼›
- æˆ‘è¿™é‡Œæš‚æ—¶çš„åšæ³•æ˜¯æŠŠä¸å…¼å®¹çš„æ’ä»¶å…ˆåˆ é™¤æ‰ï¼Œä¹Ÿå°±æ˜¯ä¸å…¼å®¹çš„æ’ä»¶ä¸æ˜¾ç¤ºå®ƒçš„æ‰“åŒ…æ—¶é—´å°±å¯ä»¥äº†ï¼›

**speed-measure-webpack-plugin**

**åˆ†æä¸€ï¼šæ‰“åŒ…çš„æ—¶é—´åˆ†æ**

- **ç¬¬ä¸€æ­¥ï¼Œå®‰è£…speed-measure-webpack-pluginæ’ä»¶**

npm install speed-measure-webpack-plugin -D![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.031.png)

- **ç¬¬äºŒæ­¥ï¼Œä½¿ç”¨speed-measure-webpack-pluginæ’ä»¶**
- åˆ›å»ºæ’ä»¶å¯¼å‡ºçš„å¯¹è±¡ SpeedMeasurePluginï¼›
- ä½¿ç”¨ smp.wrap åŒ…è£¹æˆ‘ä»¬å¯¼å‡ºçš„webpacké…ç½®ï¼›

![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.032.png)

**åˆ†æäºŒï¼šæ‰“åŒ…åæ–‡ä»¶åˆ†æ**

- **æ–¹æ¡ˆä¸€ï¼šç”Ÿæˆä¸€ä¸ªstats.jsonçš„æ–‡ä»¶**

"buiebpack ld:stats": "w--config ./config/webpack.common.js --env production --profile --json=stats.json",![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.033.png)

- **é€šè¿‡æ‰§è¡Œnpm run build:statuså¯ä»¥è·å–åˆ°ä¸€ä¸ªstats.jsonçš„æ–‡ä»¶ï¼š**
- è¿™ä¸ªæ–‡ä»¶æˆ‘ä»¬è‡ªå·±åˆ†æä¸å®¹æ˜“çœ‹åˆ°å…¶ä¸­çš„ä¿¡æ¯ï¼›
- å¯ä»¥æ”¾åˆ° [http://webpack.github.com/analyseï¼Œè¿›è¡Œåˆ†](http://webpack.github.com/analyse)æ

![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.034.png)

- **æ–¹æ¡ˆäºŒï¼šä½¿ç”¨webpack-bundle-analyzerå·¥å…·**
- å¦ä¸€ä¸ªéå¸¸ç›´è§‚æŸ¥çœ‹åŒ…å¤§å°çš„å·¥å…·æ˜¯webpack-bundle-analyzerã€‚
- **ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å®‰è£…è¿™ä¸ªå·¥å…·ï¼š**

npm install webpack-bundle-analyzer -D![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.035.png)

- **ç¬¬äºŒæ­¥ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨webpacké…ç½®ä¸­ä½¿ç”¨è¯¥æ’ä»¶ï¼š**

![](./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.036.jpeg)

- **åœ¨æ‰“åŒ…webpackçš„æ—¶å€™ï¼Œè¿™ä¸ªå·¥å…·æ˜¯å¸®åŠ©æˆ‘ä»¬æ‰“å¼€ä¸€ä¸ª8888ç«¯å£ä¸Šçš„æœåŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥çš„çœ‹åˆ°æ¯ä¸ªåŒ…çš„å¤§å°ã€‚**
- æ¯”å¦‚æœ‰ä¸€ä¸ªåŒ…æ—¶é€šè¿‡ä¸€ä¸ªVueç»„ä»¶æ‰“åŒ…çš„ï¼Œä½†æ˜¯éå¸¸çš„å¤§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è€ƒè™‘æ˜¯å¦å¯ä»¥æ‹†åˆ†å‡ºå¤šä¸ªç»„ä»¶ï¼Œå¹¶ä¸”å¯¹å…¶è¿›è¡Œæ‡’åŠ è½½ï¼›
- æ¯”å¦‚ä¸€ä¸ªå›¾ç‰‡æˆ–è€…å­—ä½“æ–‡ä»¶ç‰¹åˆ«å¤§ï¼Œæ˜¯å¦å¯ä»¥å¯¹å…¶è¿›è¡Œå‹ç¼©æˆ–è€…å…¶ä»–çš„ä¼˜åŒ–å¤„ç†ï¼›

[ref1]: ./image/Aspose.Words.92cd36f5-5044-4cfb-a5d4-6cab8d5c120b.013.png
