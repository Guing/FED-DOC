<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-浏览器/IndexedDB数据库/IndexedDB使用">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/FED-DOC/blog/rss.xml" title="IT学习笔记 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/FED-DOC/blog/atom.xml" title="IT学习笔记 Atom Feed"><title data-rh="true">IndexedDB使用与出坑指南 | IT学习笔记</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://guing.github.io/FED-DOC/docs/浏览器/IndexedDB数据库/IndexedDB使用"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="IndexedDB使用与出坑指南 | IT学习笔记"><meta data-rh="true" name="description" content="本文通过对IndexedDB的使用方法和使用场景进行相关介绍，对常见的问题进行解答。"><meta data-rh="true" property="og:description" content="本文通过对IndexedDB的使用方法和使用场景进行相关介绍，对常见的问题进行解答。"><link data-rh="true" rel="icon" href="/FED-DOC/img/my.jpg"><link data-rh="true" rel="canonical" href="https://guing.github.io/FED-DOC/docs/浏览器/IndexedDB数据库/IndexedDB使用"><link data-rh="true" rel="alternate" href="https://guing.github.io/FED-DOC/docs/浏览器/IndexedDB数据库/IndexedDB使用" hreflang="en"><link data-rh="true" rel="alternate" href="https://guing.github.io/FED-DOC/docs/浏览器/IndexedDB数据库/IndexedDB使用" hreflang="x-default"><link rel="stylesheet" href="/FED-DOC/assets/css/styles.5627add0.css">
<link rel="preload" href="/FED-DOC/assets/js/runtime~main.ada051c7.js" as="script">
<link rel="preload" href="/FED-DOC/assets/js/main.711a6047.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/FED-DOC/"><div class="navbar__logo"><img src="/FED-DOC/img/my.jpg" alt="IT学习笔记" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/FED-DOC/img/my.jpg" alt="IT学习笔记" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">IT学习笔记</b></a><a class="navbar__item navbar__link navbar__link--active" href="/FED-DOC/docs/intro">前端</a><a class="navbar__item navbar__link" href="/FED-DOC/blog">博客</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Guing/FED-DOC" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/FED-DOC/docs/intro">前端学习笔记</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/FED-DOC/docs/Html/MDN笔记/">Html</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/FED-DOC/docs/Css/2021必修 CSS架构系统精讲/2-3 CSS设计模式/note">Css</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/FED-DOC/docs/Vue/Nuxt-前端老张/笔记">Vue</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/FED-DOC/docs/React/React17系统精讲结合TS打造旅游电商平台2021/笔记/">React</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/FED-DOC/docs/Nodejs/intro">Nodejs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/FED-DOC/docs/TypeScript/Typescript入门学习笔记/">TypeScript</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/FED-DOC/docs/小程序/codewhy前端体系-小程序/总结">小程序</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/FED-DOC/docs/浏览器/IndexedDB数据库/IndexedDB使用">浏览器</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/FED-DOC/docs/浏览器/IndexedDB数据库/IndexedDB使用">IndexedDB数据库</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/FED-DOC/docs/浏览器/IndexedDB数据库/IndexedDB使用">IndexedDB使用与出坑指南</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/FED-DOC/docs/性能优化/vue-cli优化">性能优化</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/FED-DOC/docs/网络协议/intro">网络协议</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/FED-DOC/docs/工程化/intro">工程化</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/FED-DOC/docs/单元测试/intro">单元测试</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/FED-DOC/docs/构建工具/webpack基础使用">构建工具</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/FED-DOC/docs/安全/intro">安全</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/FED-DOC/docs/算法/300分钟搞定数据结构与算法/">算法</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/FED-DOC/docs/移动端/intro">移动端</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/FED-DOC/docs/体系/慕课网前端架构师/需求/1周 需求分析和架构设计/乐高架构方案设计文档">体系</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/FED-DOC/docs/面试/webpack面试题/">面试</a></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/FED-DOC/">🏠</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><span class="breadcrumbs__link" itemprop="item name">浏览器</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><span class="breadcrumbs__link" itemprop="item name">IndexedDB数据库</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">IndexedDB使用与出坑指南</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>IndexedDB使用与出坑指南</h1><h1>概述</h1><p>本文通过对<code>IndexedDB</code>的使用方法和使用场景进行相关介绍，对常见的问题进行解答。</p><p>同时，因为MDN中的相关文档缺乏相关逻辑性，所以不容易理解。本文将通过项目中常见的数据存储和操作需求来进行内容组织。</p><p>读者能够通过本文学会在项目中正确的使用<code>IndexedDB</code>，给应用带来的本地存储能力，并且避免一些常见的问题。</p><h1>原因：开发者需要在本地进行永久存储</h1><p>当我们进行一些较大的SPA页面开发时，我们会需要进行一些数据的本地存储。</p><p>当数据量不大时，我们可以通过SessionStorage或者LocalStorage来进行存储，但是当数据量较大，或符合一定的规范时，我们可以使用数据库来进行数据的存储。</p><p>在浏览器提供的数据库中，共有<code>web sql</code>和<code>IndexedDB</code>两种。相较于HTML5已经废弃的<code>web sql</code>来说，更推荐大家使用<code>IndexedDB</code>。</p><h1>结构</h1><p>下面，我们通过一张图来了解下，IndexedDB整体的结构。</p><p><img loading="lazy" alt="img" src="data:;base64,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" width="553" height="94" class="img_E7b_"></p><p>类比<code>sql</code>型数据库，<code>IndexedDB</code>中的DB（数据库）就是<code>sql</code>中的DB，而<code>Object Store(存储空间)</code>则是<code>数据表</code>,<code>Item</code>则等于表中的一条<code>记录</code>。</p><h1>使用IndexedDB</h1><p>现在，我们将其根据<code>IndexedDB</code>的结构来对其操作进行介绍，能让大家对这个存储空间有一个初步的了解。我们主要介绍：</p><ul><li>数据库操作</li><li>数据表操作</li><li>数据操作</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="数据库操作">数据库操作<a class="hash-link" href="#数据库操作" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="创建或打开数据库">创建或打开数据库<a class="hash-link" href="#创建或打开数据库" title="Direct link to heading">​</a></h3><p>使用<code>IndexedDB</code>第一步，就是创建或打开一个数据库。我们使用<code>window.indexedDB.open(DBName)</code>这个API来打进行操作。具体示例如下：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">const request = window.indexedDB.open(&#x27;test&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">request.onupgradeneeded = function (event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">request.onsuccess = function(event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //request === event.target;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">request.onerror = function(event) {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>调用此接口时，如果当前数据库不存在，则会创建一个新的数据库。</p><p>当数据库建立连接时，会返回一个<code>IDBOpenDBRequest</code>对象。</p><p>在连接建立成功时，会触发<code>onsuccess</code>事件，其中函数参数<code>event</code>的<code>target</code>属性就是<code>request</code>对象。</p><p>而在数据库创建或者版本更新时，会触发<code>onupgradeneeded</code>事件。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="更新数据库版本号">更新数据库版本号<a class="hash-link" href="#更新数据库版本号" title="Direct link to heading">​</a></h3><p><code>window.indexedDB.open</code>的第二个参数即为版本号。在不指定的情况下，默认版本号为1。具体示例如下:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">const request = window.indexedDB.open(&#x27;test&#x27;, 2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>在需要更新数据库的<code>schema(模式)</code>时，需要更新版本号。此时我们指定一个高于之前版本的版本号，就会触发<code>onupgradeneeded</code>事件。类似的，当此数据库不存在时，也会触发此事件并且将版本更新到置顶版本。</p><p>我们需要注意的是，版本号是一个<code>Unsigned long long</code>数字，这意味着它可以是一个非常大的整数。但是，它不能是一个小数，否则它将会被转为最近的整数，同时有可能导致<code>onUpgradeneeded</code>事件不触发(bug)。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="存储空间操作">存储空间操作<a class="hash-link" href="#存储空间操作" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="创建存储空间">创建存储空间<a class="hash-link" href="#创建存储空间" title="Direct link to heading">​</a></h3><p>我们使用<code>createObjectStore</code>来创建一个存储空间。同时，使用<code>createIndex</code>来创建它的索引。具体示例如下：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">var request = window.indexedDB.open(&#x27;test&#x27;, 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">request.onupgradeneeded = function (event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var db = event.target.result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var objectStore = db.createObjectStore(&#x27;table1&#x27;, {keyPath: &#x27;id&#x27;, autoIncrement: true});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    objectStore.createIndex(&#x27;name&#x27;, &#x27;name&#x27;, {unique: false});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">request.onerror = function (event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alert(&quot;Why didn&#x27;t you allow my web app to use IndexedDB?!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>注：只能在<code>onupgradeneeded</code>回调函数中创建存储空间，而不能在数据库打开后的<code>success</code>回调函数中创建。</strong></p><p>通过<code>createObjectStore</code>能够创建一个存储空间。接受两个参数：</p><ol><li>第一个参数，存储空间的名称，即我们上面的<code>customers</code>。</li><li>第二个参数，指定存储的<code>keyPath</code>值为存储对象的某个属性，这个属性能够在获取存储空间数据的时候当做key值使用。<code>autoIncrement</code>指定了<code>key</code>值是否自增（当key值为默认的从1开始到2^53的整数时）。</li></ol><p>而<code>createIndex</code>能够给当前的存储空间设置一个索引。它接受三个参数：</p><ol><li>第一个参数，索引的名称。</li><li>第二个参数，指定根据存储数据的哪一个属性来构建索引。</li><li>第三个属性， options对象，其中属性<code>unique</code>的值为<code>true</code>表示不允许索引值相等。</li></ol><h2 class="anchor anchorWithStickyNavbar_mojV" id="数据操作">数据操作<a class="hash-link" href="#数据操作" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="事务">事务<a class="hash-link" href="#事务" title="Direct link to heading">​</a></h3><p>在<code>IndexedDB</code>中，我们也能够使用事务来进行数据库的操作。事务有三个模式（常量已经弃用）：</p><ul><li><code>readOnly</code>，只读。</li><li><code>readwrite</code>，读写。</li><li><code>versionchange</code>，数据库版本变化。</li></ul><p>我们创建一个事务时，需要从上面选择一种模式，如果不指定的话，则默认为只读模式。具体示例如下：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">const transaction = db.transaction([&#x27;customers&#x27;], &#x27;readwrite&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>事务函数<code>transaction</code>的第一个参数为需要关联的存储空间，第二个可选参数为事务模式。与上面类似，事务成功时也会触发<code>onsuccess</code>函数，失败时触发<code>onerror</code>函数。</p><p>事务的操作都是原子性的。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="增加数据">增加数据<a class="hash-link" href="#增加数据" title="Direct link to heading">​</a></h3><p>当存储空间初始化完成后，我们可以把数据放入存储空间中。直接调用<code>add</code>方法就可以将数据放入存储空间内，具体示例如下：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">var request = window.indexedDB.open(&#x27;test&#x27;, 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">request.onsuccess = function (event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var db = event.target.result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var transaction = db.transaction([&#x27;table1&#x27;], &#x27;readwrite&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var objectStore = transaction.objectStore(&#x27;table1&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var index = objectStore.index(&#x27;name&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    objectStore.add({name: &#x27;a&#x27;, age: 10});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    objectStore.add({name: &#x27;b&#x27;, age: 20});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>注：<code>add</code>方法中的第二个参数key值是指定存储空间中的<code>keyPath</code>值，如果<code>data</code>中包含<code>keyPath</code>值或者此值为自增值，那么可以略去此参数。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="查找数据">查找数据<a class="hash-link" href="#查找数据" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="通过特定值获取数据">通过特定值获取数据<a class="hash-link" href="#通过特定值获取数据" title="Direct link to heading">​</a></h4><p>当我们需要从存储空间获取数据时，我们可以通过以下的方法：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">var request = window.indexedDB.open(&#x27;test&#x27;, 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">request.onsuccess = function (event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var db = event.target.result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var transaction = db.transaction([&#x27;table1&#x27;], &#x27;readwrite&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var objectStore = transaction.objectStore(&#x27;table1&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var request = objectStore.get(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    request.onsuccess = function (event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 对 request.result 做些操作！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        console.log(request.result);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    request.onerror = function (event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 错误处理!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="通过游标获取数据">通过游标获取数据<a class="hash-link" href="#通过游标获取数据" title="Direct link to heading">​</a></h4><p>当你需要遍历整个存储空间中的数据时，你就需要使用到游标。游标使用方法如下：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">var request = window.indexedDB.open(&#x27;test&#x27;, 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">request.onsuccess = function (event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var db = event.target.result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var transaction = db.transaction([&#x27;table1&#x27;], &#x27;readwrite&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var objectStore = transaction.objectStore(&#x27;table1&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var request = objectStore.openCursor();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    request.onsuccess = function (event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var cursor = event.target.result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (cursor) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 使用Object.assign方法是为了避免控制台打印时出错</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            console.log(Object.assign(cursor.value));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cursor.continue();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    request.onerror = function (event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 错误处理!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>使用游标时有一个需要注意的地方，当游标遍历整个存储空间但是并未找到给定条件的值时，仍然会触发<code>onsuccess</code>函数。</p><p><code>openCursor</code>和<code>openKeyCursor</code>有两个参数：</p><ol><li><p>第一个参数，遍历范围，指定游标的访问范围。该范围通过一个<code>IDBKeyRange</code>参数的方法来获取。</p><p>遍历范围参数具体示例如下：</p></li></ol><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">// 匹配值 key === 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const singleKeyRange = IDBKeyRange.only(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 匹配值 key &gt;= 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const lowerBoundKeyRange = IDBKeyRange.lowerBound(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 匹配值 key &gt; 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const lowerBoundOpenKeyRange = IDBKeyRange.lowerBound(1, true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 匹配值 key &lt; 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const upperBoundOpenKeyRange = IDBKeyRange.upperBound(2, true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 匹配值 key &gt;= 1 &amp;&amp; key &lt; 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const boundKeyRange = IDBKeyRange.bound(1, 2, false, true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">index.openCursor(boundKeyRange).onsuccess = function(event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const cursor = event.target.result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (cursor) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Do something with the matches.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cursor.continue();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ol><li><p>第二个参数，遍历顺序，指定游标遍历时的顺序和处理相同id（keyPath属性指定字段）重复时的处理方法。改范围通过特定的字符串（<code>IDBCursor</code>的常量已经弃用）来获取。其中：</p><ul><li><code>next</code>，从前往后获取所有数据（包括重复数据）</li><li><code>prev</code>，从后往前获取所有数据（包括重复数据）</li><li><code>nextunique</code>，从前往后获取数据（重复数据只取第一条，索引重复即认为重复，下同）</li><li><code>prevunique</code>，从后往前获取数据（重复数据只取第一条）</li></ul><p>遍历顺序参数具体示例如下：</p></li></ol><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">var request = window.indexedDB.open(&#x27;test&#x27;, 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">request.onsuccess = function (event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var db = event.target.result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var transaction = db.transaction([&#x27;table1&#x27;], &#x27;readwrite&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var objectStore = transaction.objectStore(&#x27;table1&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var lowerBoundOpenKeyRange = IDBKeyRange.lowerBound(1, false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var request = objectStore.openCursor(lowerBoundOpenKeyRange, IDBCursor.PREV);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    request.onsuccess = function (event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var cursor = event.target.result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (cursor) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 使用Object.assign方法是为了避免控制台打印时出错</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            console.log(Object.assign(cursor.value));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cursor.continue();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    request.onerror = function (event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 错误处理!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="使用索引">使用索引<a class="hash-link" href="#使用索引" title="Direct link to heading">​</a></h4><p>在前面构建数据库时，我们创建了两个索引。现在我们也可以通过索引来进行数据检索。他的本质还是通过之前获取数据的API来进行，只是将原来使用的<code>keyPath</code>属性转换成为了索引指定的属性。具体示例如下：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">var request = window.indexedDB.open(&#x27;test&#x27;, 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">request.onsuccess = function (event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var db = event.target.result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var transaction = db.transaction([&#x27;table1&#x27;], &#x27;readwrite&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var objectStore = transaction.objectStore(&#x27;table1&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var index = objectStore.index(&#x27;name&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 第一种，get方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    index.get(&#x27;a&#x27;).onsuccess = function (event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        console.log(event.target.result);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 第二种，普通游标方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    index.openCursor().onsuccess = function (event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        console.log(&#x27;openCursor:&#x27;, event.target.result.value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 第三种，键游标方法，该方法与第二种的差别为：普通游标带有value值表示获取的数据，而键游标没有</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    index.openKeyCursor().onsuccess = function (event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        console.log(&#x27;openKeyCursor:&#x27;, event.target.result);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="修改数据">修改数据<a class="hash-link" href="#修改数据" title="Direct link to heading">​</a></h3><p>当需要修改存储空间中的数据时，我们可以使用以下的API：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">var objectStore = transaction.objectStore(&quot;customers&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var request = objectStore.put(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">request.onsuccess = function (event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>注：<code>put</code>方法不仅能够修改现有数据，也能够往存储空间中增加新的数据。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="删除数据">删除数据<a class="hash-link" href="#删除数据" title="Direct link to heading">​</a></h3><p>当我们需要删除已经无用的数据时，我们可以通过以下方法：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">var objectStore = transaction.objectStore(&quot;customers&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var request = objectStore.delete(name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">request.onsuccess = function (event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="异常处理">异常处理<a class="hash-link" href="#异常处理" title="Direct link to heading">​</a></h2><p>在浏览器有如下操作的情况下，indexedDB可能会出现异常：</p><ul><li>用户清除浏览器缓存</li><li>存储空间超过大小限制</li></ul><p>此时，需要对错误进行捕获，并且对用户进行提示。此章节不是本文重点，再此略过。</p><h1>扩展须知</h1><h2 class="anchor anchorWithStickyNavbar_mojV" id="取值相关">取值相关<a class="hash-link" href="#取值相关" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="key值能够接受的数据类型">key值能够接受的数据类型<a class="hash-link" href="#key值能够接受的数据类型" title="Direct link to heading">​</a></h3><p>在<code>IndexedDB</code>中，键值对中的<code>key</code>值可以接受以下几种类型的值：</p><ul><li>number</li><li>data</li><li>string</li><li>binary</li><li>array</li></ul><p>具体说明可以见文档<a href="https://link.juejin.cn/?target=https%3A%2F%2Fw3c.github.io%2FIndexedDB%2F%23key-construct" target="_blank" rel="noopener noreferrer">此处</a>。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="key-path能够接受的数据类型">key path能够接受的数据类型<a class="hash-link" href="#key-path能够接受的数据类型" title="Direct link to heading">​</a></h3><p>当一个<code>key</code>值变为主键，即<code>keyPath</code>时，它的值就只能是以下几种：</p><ul><li>Blob</li><li>File</li><li>Array</li><li>String</li></ul><p><strong>注：空格不能出现在key path中</strong>。</p><p>具体说明可以见文档<a href="https://link.juejin.cn/?target=https%3A%2F%2Fw3c.github.io%2FIndexedDB%2F%23key-path-construct" target="_blank" rel="noopener noreferrer">此处</a>。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="value能够接受的数据类型">value能够接受的数据类型<a class="hash-link" href="#value能够接受的数据类型" title="Direct link to heading">​</a></h3><p>在<code>IndexedDB</code>中，value能够接受ECMA-262中所有的类型的值，例如String，Date，ImageDate等。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="事务相关">事务相关<a class="hash-link" href="#事务相关" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="事务中断后会不会影响key值的自增">事务中断后，会不会影响key值的自增<a class="hash-link" href="#事务中断后会不会影响key值的自增" title="Direct link to heading">​</a></h3><p><code>IndexedDB</code>在没有指定key值的时候就会采用自增的key值。如果一个事务在中途中断，那么key值的自增将会从中断的事务开始前的key开始。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="安全相关">安全相关<a class="hash-link" href="#安全相关" title="Direct link to heading">​</a></h2><p><code>IndexedDB</code>也受到浏览器<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FSecurity%2FSame-origin_policy" target="_blank" rel="noopener noreferrer">同源策略</a>的限制。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="用户相关">用户相关<a class="hash-link" href="#用户相关" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="清空缓存">清空缓存<a class="hash-link" href="#清空缓存" title="Direct link to heading">​</a></h3><p>用户在清除浏览器缓存时，可能会清除<code>IndexedDB</code>中相关的数据。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="访问权限">访问权限<a class="hash-link" href="#访问权限" title="Direct link to heading">​</a></h3><p>部分浏览器如Safari手机版隐私模式在访问<code>IndexedDB</code>时，可能会出现由于没有权限而导致的异常（LocalStorage也会），需要进行异常处理。</p><h1>总结</h1><p><code>IndexedDB</code>在本地存储中有着无可替代的作用，是替代关系型数据库<code>web sql</code>的产品，能够对大量数据进行存储。在许多需要运用离线存储的场景下，它能够给我们提供有效的支撑。</p><p>但是，<code>IndexedDB</code>在使用过程中仍然需要避免可能会出现的一些问题，或者对可能导致的不利影响有一定的容错处理。这样才不会对应用产生重大影响。</p><h1>参考文献</h1><ul><li><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FSecurity%2FSame-origin_policy" target="_blank" rel="noopener noreferrer">浏览器的同源策略</a></p></li><li><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FIndexedDB_API%2FUsing_IndexedDB" target="_blank" rel="noopener noreferrer">使用indexedDB MDN入门</a></p></li><li><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FIndexedDB_API" target="_blank" rel="noopener noreferrer">IndexedDB API参考</a></p></li><li><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fw3c.github.io%2FIndexedDB%2F" target="_blank" rel="noopener noreferrer">W3C IndexedDB 2.0规范</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/104536473" target="_blank" rel="noopener noreferrer">前端大容量缓存方案-IndexedDB</a></p></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Guing/FED-DOC/docs/10-浏览器/IndexedDB数据库/IndexedDB使用.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/FED-DOC/docs/小程序/intro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">intro</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/FED-DOC/docs/性能优化/vue-cli优化"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">vue-cli优化</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#数据库操作" class="table-of-contents__link toc-highlight">数据库操作</a><ul><li><a href="#创建或打开数据库" class="table-of-contents__link toc-highlight">创建或打开数据库</a></li><li><a href="#更新数据库版本号" class="table-of-contents__link toc-highlight">更新数据库版本号</a></li></ul></li><li><a href="#存储空间操作" class="table-of-contents__link toc-highlight">存储空间操作</a><ul><li><a href="#创建存储空间" class="table-of-contents__link toc-highlight">创建存储空间</a></li></ul></li><li><a href="#数据操作" class="table-of-contents__link toc-highlight">数据操作</a><ul><li><a href="#事务" class="table-of-contents__link toc-highlight">事务</a></li><li><a href="#增加数据" class="table-of-contents__link toc-highlight">增加数据</a></li><li><a href="#查找数据" class="table-of-contents__link toc-highlight">查找数据</a></li><li><a href="#修改数据" class="table-of-contents__link toc-highlight">修改数据</a></li><li><a href="#删除数据" class="table-of-contents__link toc-highlight">删除数据</a></li></ul></li><li><a href="#异常处理" class="table-of-contents__link toc-highlight">异常处理</a></li><li><a href="#取值相关" class="table-of-contents__link toc-highlight">取值相关</a><ul><li><a href="#key值能够接受的数据类型" class="table-of-contents__link toc-highlight">key值能够接受的数据类型</a></li><li><a href="#key-path能够接受的数据类型" class="table-of-contents__link toc-highlight">key path能够接受的数据类型</a></li><li><a href="#value能够接受的数据类型" class="table-of-contents__link toc-highlight">value能够接受的数据类型</a></li></ul></li><li><a href="#事务相关" class="table-of-contents__link toc-highlight">事务相关</a><ul><li><a href="#事务中断后会不会影响key值的自增" class="table-of-contents__link toc-highlight">事务中断后，会不会影响key值的自增</a></li></ul></li><li><a href="#安全相关" class="table-of-contents__link toc-highlight">安全相关</a></li><li><a href="#用户相关" class="table-of-contents__link toc-highlight">用户相关</a><ul><li><a href="#清空缓存" class="table-of-contents__link toc-highlight">清空缓存</a></li><li><a href="#访问权限" class="table-of-contents__link toc-highlight">访问权限</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">笔记</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/FED-DOC/docs/intro">前端</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/Guing" target="_blank" rel="noopener noreferrer" class="footer__link-item">关于我<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/FED-DOC/blog">博客</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 FED-DOCS, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/FED-DOC/assets/js/runtime~main.ada051c7.js"></script>
<script src="/FED-DOC/assets/js/main.711a6047.js"></script>
</body>
</html>